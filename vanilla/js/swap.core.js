!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.core=e():(t.swap=t.swap||{},t.swap.core=e())}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=232)}([function(t,e){var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(45));e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){var r=n(35)("wks"),i=n(25),o=n(2).Symbol,s="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=r},function(t,e,n){var r=n(2),i=n(0),o=n(21),s=n(12),a=n(11),u=function(t,e,n){var c,f,l,h=t&u.F,d=t&u.G,p=t&u.S,v=t&u.P,w=t&u.B,y=t&u.W,g=d?i:i[e]||(i[e]={}),_=g.prototype,b=d?r:p?r[e]:(r[e]||{}).prototype;for(c in d&&(n=e),n)(f=!h&&b&&void 0!==b[c])&&a(g,c)||(l=f?b[c]:n[c],g[c]=d&&"function"!=typeof b[c]?n[c]:w&&f?o(l,r):y&&b[c]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):v&&"function"==typeof l?o(Function.call,l):l,v&&((g.virtual||(g.virtual={}))[c]=l,t&u.R&&_&&!_[c]&&s(_,c,l)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var r=n(9),i=n(55),o=n(40),s=Object.defineProperty;e.f=n(7)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=!n(14)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(57),i=n(30);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(10);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(6),i=n(18);t.exports=n(7)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){t.exports={default:n(72),__esModule:!0}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(54),i=n(36);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.util=e.constants=e.Events=e.Collection=e.SwapInterface=e.ServiceInterface=void 0;var r=f(n(51)),i=f(n(86)),o=f(n(87)),s=f(n(88)),a=f(n(89)),u=f(n(28)),c=f(n(90));function f(t){return t&&t.__esModule?t:{default:t}}e.default=r.default,e.ServiceInterface=i.default,e.SwapInterface=o.default,e.Collection=s.default,e.Events=a.default,e.constants=u.default,e.util=c.default},function(t,e){t.exports=!0},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(30);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(39);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports={}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(97),i=n(98),o=n(68);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(f(e),t=a(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(t).length;default:if(r)return H(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function w(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var l=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){l=!1;break}if(l)return o}return-1}function g(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function _(t,e,n,r){return W(H(e,t.length-n),t,n,r)}function b(t,e,n,r){return W(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function m(t,e,n,r){return b(t,e,n,r)}function S(t,e,n,r){return W(D(e),t,n,r)}function x(t,e,n,r){return W(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],f=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=n)switch(l){case 1:c<128&&(f=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(f=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,a=Math.min(o,s),c=this.slice(r,i),f=t.slice(e,n),l=0;l<a;++l)if(c[l]!==f[l]){o=c[l],s=f[l];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return w(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return w(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return m(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function M(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=U(t[o]);return i}function P(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function R(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,o){return o||R(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function j(t,e,n,r,o){return o||R(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:H(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function D(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function W(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(26))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(81)),i=a(n(82)),o=a(n(83)),s=a(n(84));function a(t){return t&&t.__esModule?t:{default:t}}e.default={COINS:r.default,ENV:i.default,SERVICES:o.default,NETWORKS:s.default},t.exports=e.default},function(t,e){var n={Array:function(t){return null!==t&&void 0!==t&&t.constructor===Array},Boolean:function(t){return"boolean"==typeof t},Function:function(t){return"function"==typeof t},Nil:function(t){return void 0===t||null===t},Number:function(t){return"number"==typeof t},Object:function(t){return"object"==typeof t},String:function(t){return"string"==typeof t},"":function(){return!0}};for(var r in n.Null=n.Nil,n)n[r].toJSON=function(t){return t}.bind(null,r);t.exports=n},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){t.exports={default:n(118),__esModule:!0}},function(t,e,n){var r=n(6).f,i=n(11),o=n(4)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(35)("keys"),i=n(25);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(0),i=n(2),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(17)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(53));e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";e.__esModule=!0;var r=s(n(129)),i=s(n(133)),o=s(n(53));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,o.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r.default?(0,r.default)(t,e):t.__proto__=e)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(10);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(27),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){var r=n(5),i=n(0),o=n(14);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},function(t,e,n){var r=n(10),i=n(2).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(9),i=n(103),o=n(36),s=n(34)("IE_PROTO"),a=function(){},u=function(){var t,e=n(43)("iframe"),r=o.length;for(e.style.display="none",n(66).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[s]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){t.exports={default:n(76),__esModule:!0}},function(t,e,n){t.exports={default:n(78),__esModule:!0}},function(t,e,n){var r=n(31),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){e.f=n(4)},function(t,e,n){var r=n(2),i=n(0),o=n(17),s=n(48),a=n(6).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(n(46)),i=c(n(13)),o=c(n(1)),s=c(n(3)),a=c(n(28)),u=c(n(85));function c(t){return t&&t.__esModule?t:{default:t}}var f=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"setup",value:function(t){this.network=t.network||a.default.NETWORKS.TESTNET,this.env={},this.services={},this.swaps={},this.flows={},this._addEnv(t.env||{}),this._addServices(t.services||{}),this._addSwaps(t.swaps||{}),this._addFlows(t.flows||{})}},{key:"_addEnv",value:function(t){(0,i.default)(t).forEach(function(t){if((0,r.default)(a.default.ENV).indexOf(t)<0)throw new Error("SwapApp.addEnv(): Only "+(0,r.default)(a.default.ENV)+" available")}),this.env=t,this.env.storage=new u.default(t.storage)}},{key:"_addService",value:function(t){if(!t._serviceName)throw new Error('SwapApp service should contain "_serviceName" property');if(!(0,r.default)(a.default.SERVICES).includes(t._serviceName))throw new Error('SwapApp service should contain "_serviceName" property should be one of '+(0,r.default)(a.default.SERVICES)+', got "'+t._serviceName+'"');this.services[t._serviceName]=t}},{key:"_addServices",value:function(t){var e=this;t.forEach(function(t){return e._addService(t)}),(0,i.default)(this.services).forEach(function(t){return e.services[t]._waitRelationsResolve()}),(0,i.default)(this.services).forEach(function(t){return e.services[t]._tryInitService()})}},{key:"_addSwap",value:function(t){if(!t._swapName)throw new Error('SwapApp swap should contain "_swapName" property');if(!(0,r.default)(a.default.COINS).includes(t._swapName.toUpperCase()))throw new Error('SwapApp swap should contain "_swapName" property should be one of '+(0,r.default)(a.default.COINS)+', got "'+t._swapName.toUpperCase()+'"');this.swaps[t._swapName]=t,"function"==typeof t._initSwap&&t._initSwap()}},{key:"_addSwaps",value:function(t){var e=this;t.forEach(function(t){e._addSwap(t)})}},{key:"_addFlow",value:function(t){var e=t.getName();if(!/^[A-Za-z]+2[A-Za-z]+$/.test(e))throw new Error('SwapApp flow "_flowName" property should be "^[A-Za-z]+2[A-Za-z]+$" format');var n=e.match(/^[^\d]+/),i=e.match(/[^\d]+$/);if(!(n&&i&&(0,r.default)(a.default.COINS).includes(n[0].toUpperCase())&&(0,r.default)(a.default.COINS).includes(i[0].toUpperCase())))throw new Error('SwapApp flow "_flowName" property should contain only: '+(0,r.default)(a.default.COINS)+'. Got: "'+e.toUpperCase()+'"');this.flows[e]=t}},{key:"_addFlows",value:function(t){var e=this;t.forEach(function(t){e._addFlow(t)})}},{key:"isMainNet",value:function(){return this.network.toLowerCase()===a.default.NETWORKS.MAINNET}},{key:"isTestNet",value:function(){return this.network.toLowerCase()===a.default.NETWORKS.TESTNET}},{key:"isLocalNet",value:function(){return this.network.toLowerCase()===a.default.NETWORKS.LOCALNET}}]),t}();e.default=new f,t.exports=e.default},function(t,e,n){var r=n(29);function i(t){return t.name||t.toString().match(/function (.*?)\s*\(/)[1]}function o(t){return r.Nil(t)?"":i(t.constructor)}function s(t){return r.Function(t)?t.toJSON?t.toJSON():i(t):r.Array(t)?"Array":t&&r.Object(t)?"Object":void 0!==t?t:""}function a(t,e,n){var i=function(t){return r.Function(t)?"":r.String(t)?JSON.stringify(t):t&&r.Object(t)?"":t}(e);return"Expected "+s(t)+", got"+(""!==n?" "+n:"")+(""!==i?" "+i:"")}function u(t,e,n){n=n||o(e),this.message=a(t,e,n),Error.captureStackTrace(this,u),this.__type=t,this.__value=e,this.__valueTypeName=n}function c(t,e,n,r,i){t?(i=i||o(r),this.message=function(t,e,n,r,i){var o='" of type ';return"key"===e&&(o='" with key type '),a('property "'+s(n)+o+s(t),r,i)}(t,n,e,r,i)):this.message='Unexpected property "'+e+'"',Error.captureStackTrace(this,u),this.__label=n,this.__property=e,this.__type=t,this.__value=r,this.__valueTypeName=i}u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,c.prototype=Object.create(Error.prototype),c.prototype.constructor=u,t.exports={TfTypeError:u,TfPropertyTypeError:c,tfCustomError:function(t,e){return new u(t,{},e)},tfSubError:function(t,e,n){return t instanceof c?(e=e+"."+t.__property,t=new c(t.__type,e,t.__label,t.__value,t.__valueTypeName)):t instanceof u&&(t=new c(t.__type,e,n,t.__value,t.__valueTypeName)),Error.captureStackTrace(t),t},tfJSON:s,getValueTypeName:o}},function(t,e,n){"use strict";e.__esModule=!0;var r=s(n(120)),i=s(n(122)),o="function"==typeof i.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof i.default&&"symbol"===o(r.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":o(t)}},function(t,e,n){var r=n(11),i=n(8),o=n(74)(!1),s=n(34)("IE_PROTO");t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){t.exports=!n(7)&&!n(14)(function(){return 7!=Object.defineProperty(n(43)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports={default:n(71),__esModule:!0}},function(t,e,n){var r=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){"use strict";var r=n(101)(!0);n(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(17),i=n(5),o=n(65),s=n(12),a=n(22),u=n(102),c=n(33),f=n(64),l=n(4)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,p,v,w,y){u(n,e,p);var g,_,b,m=function(t){if(!h&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",x="values"==v,E=!1,k=t.prototype,T=k[l]||k["@@iterator"]||v&&k[v],O=T||m(v),A=v?x?m("entries"):O:void 0,M="Array"==e&&k.entries||T;if(M&&(b=f(M.call(new t)))!==Object.prototype&&b.next&&(c(b,S,!0),r||"function"==typeof b[l]||s(b,l,d)),x&&T&&"values"!==T.name&&(E=!0,O=function(){return T.call(this)}),r&&!y||!h&&!E&&k[l]||s(k,l,O),a[e]=O,a[S]=d,v)if(g={values:x?O:m("values"),keys:w?O:m("keys"),entries:A},y)for(_ in g)_ in k||o(k,_,g[_]);else i(i.P+i.F*(h||E),e,g);return g}},function(t,e,n){var r=n(19),i=n(18),o=n(8),s=n(40),a=n(11),u=n(55),c=Object.getOwnPropertyDescriptor;e.f=n(7)?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(a(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(143));e.default=r.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}},function(t,e,n){t.exports=n(158)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(111));e.default=function(t){return function(){var e=t.apply(this,arguments);return new r.default(function(t,n){return function i(o,s){try{var a=e[o](s),u=a.value}catch(t){return void n(t)}if(!a.done)return r.default.resolve(u).then(function(t){i("next",t)},function(t){i("throw",t)});t(u)}("next")})}}},function(t,e,n){var r=n(11),i=n(20),o=n(34)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){t.exports=n(12)},function(t,e,n){var r=n(2).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(54),i=n(36).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){n(104);for(var r=n(2),i=n(12),o=n(22),s=n(4)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],f=r[c],l=f&&f.prototype;l&&!l[s]&&i(l,s,c),o[c]=o.Array}},function(t,e){},function(t,e,n){var r=n(0),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},function(t,e,n){n(73),t.exports=n(0).Object.keys},function(t,e,n){var r=n(20),i=n(15);n(42)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(8),i=n(47),o=n(75);t.exports=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),f=o(s,c);if(t&&n!=n){for(;c>f;)if((a=u[f++])!=a)return!0}else for(;c>f;f++)if((t||f in u)&&u[f]===n)return t||f||0;return!t&&-1}}},function(t,e,n){var r=n(31),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){n(77);var r=n(0).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(5);r(r.S+r.F*!n(7),"Object",{defineProperty:n(6).f})},function(t,e,n){n(79),t.exports=n(0).Object.values},function(t,e,n){var r=n(5),i=n(80)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(15),i=n(8),o=n(19).f;t.exports=function(t){return function(e){for(var n,s=i(e),a=r(s),u=a.length,c=0,f=[];u>c;)o.call(s,n=a[c++])&&f.push(t?[n,s[n]]:s[n]);return f}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={eth:"ETH",btc:"BTC",nim:"NIM",noxon:"NOXON",swap:"SWAP",btrm:"BTRM"},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={web3:"web3",bitcoin:"bitcoin",Ipfs:"Ipfs",IpfsRoom:"IpfsRoom",storage:"storage"},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={auth:"auth",room:"room",orders:"orders",swaps:"swaps"},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={MAINNET:"mainnet",TESTNET:"testnet",LOCALNET:"localnet"},t.exports=e.default},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(56)),o=a(n(1)),s=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(e){(0,o.default)(this,t),this.prefix="swap:",this.storage=e||r.localStorage;try{this.storage.setItem("test","test"),this.storage.getItem("test"),this.storage.removeItem("test")}catch(t){throw new Error("SwapApp.env.StorageFactory: "+t)}}return(0,s.default)(t,[{key:"setItem",value:function(t,e){this.storage.setItem(""+this.prefix+t,(0,i.default)(e))}},{key:"getItem",value:function(t){var e=this.storage.getItem(""+this.prefix+t);try{return JSON.parse(e)}catch(e){return console.error("SwapApp.env.storage.getItem("+t+") parse error. Looks like the value was created w/o setItem method"),void console.error(e)}}},{key:"removeItem",value:function(t){return this.storage.removeItem(""+this.prefix+t)}}]),t}();e.default=u,t.exports=e.default}).call(this,n(26))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(13)),i=a(n(1)),o=a(n(3)),s=a(n(51));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(){(0,i.default)(this,t),this._constructor()}return(0,o.default)(t,[{key:"_constructor",value:function(){this._serviceName=null,this._dependsOn=null,this._spyHandlers=[]}}]),(0,o.default)(t,[{key:"_waitRelationsResolve",value:function(){var t=this;if(this._dependsOn&&this._dependsOn.length){var e={};this._dependsOn.forEach(function(n){e[n.name]={initialized:!1},s.default.services[n.name]._addWaitRelationHandler(function(){e[n.name].initialized=!0,(0,r.default)(e).every(function(t){return e[t].initialized})&&t.initService()})})}}},{key:"_addWaitRelationHandler",value:function(t){this._spyHandlers.push(t)}},{key:"_tryInitService",value:function(){this._dependsOn&&this._dependsOn.length||(this.initService(),this._spyHandlers.forEach(function(t){return t()}),this._spyHandlers=[])}},{key:"initService",value:function(){}}]),t}();e.default=u,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(1)),i=o(n(3));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(){(0,r.default)(this,t),this._swapName=null}return(0,i.default)(t,[{key:"_initSwap",value:function(){}}]),t}();e.default=s,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(13)),i=s(n(1)),o=s(n(3));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(){(0,i.default)(this,t),this._constructor()}return(0,o.default)(t,[{key:"_constructor",value:function(){this.items=[],this.itemIds={}}}]),(0,o.default)(t,[{key:"prepend",value:function(t,e){if(this.items.unshift(t),e){for(var n in this.itemIds)this.itemIds.hasOwnProperty(n)&&(this.itemIds[n]+=1);this.itemIds[e]=0}return t}},{key:"append",value:function(t,e){return this.items.push(t),e&&(this.itemIds[e]=this.items.length-1),t}},{key:"removeByIndex",value:function(t){this.items=this.items.splice(t,1)}},{key:"removeByKey",value:function(t){var e=this,n=this.itemIds[t];void 0!==n&&(this.items.splice(n,1),delete this.itemIds[t],(0,r.default)(this.itemIds).forEach(function(t){e.itemIds[t]>n&&e.itemIds[t]--}))}},{key:"indexOf",value:function(t){return this.items.indexOf(t)}},{key:"getByIndex",value:function(t){return this.items[t]}},{key:"getByKey",value:function(t){return this.items[this.itemIds[t]]}},{key:"isExist",value:function(t){return this.items.includes(t)}},{key:"isExistByKey",value:function(t){return Boolean(this.getByKey(t))}}]),t}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.events=void 0;var r=o(n(1)),i=o(n(3));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e){(0,r.default)(this,t),this.name=e,this.handlers=[]}return(0,i.default)(t,[{key:"addHandler",value:function(t){var e=this;this.handlers.push(t.bind({unsubscribe:function(){e.removeHandler(t)}}))}},{key:"removeHandler",value:function(t){var e=this.handlers.indexOf(t);this.handlers.splice(e,1)}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.handlers.forEach(function(t){try{t.apply(void 0,e)}catch(t){console.error(t)}})}}]),t}(),a=function(){function t(){(0,r.default)(this,t),this.events={}}return(0,i.default)(t,[{key:"getEvent",value:function(t){var e=this.events[t];return e||(e=new s(t),this.events[t]=e),e}},{key:"subscribe",value:function(t,e){var n=this.getEvent(t);return n.addHandler(e),{event:n,handler:e}}},{key:"unsubscribe",value:function(t,e){this.getEvent(t).removeHandler(e)}},{key:"dispatch",value:function(t){var e=this.getEvent(t);if(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.call.apply(e,r)}}},{key:"once",value:function(t,e){var n=this.getEvent(t),r=function t(){e.apply(void 0,arguments)&&n.removeHandler(t)};return n.addHandler(r),{event:n,handlerWrapper:r}}}]),t}(),u=new a;e.default=a,e.events=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(91)),i=s(n(92)),o=s(n(93));function s(t){return t&&t.__esModule?t:{default:t}}e.default={pullProps:r.default,ignoreProps:i.default,typeforce:o.default},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i={};return n.forEach(function(e){i[e]=t[e]}),i},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(13));e.default=function(){for(var t=arguments.length,e=Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o={};return(0,r.default)(i).forEach(function(t){e.includes(t)||(o[t]=i[t])}),o},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=c(n(94)),s=c(n(46)),a=c(n(95)),u=c(n(28));function c(t){return t&&t.__esModule?t:{default:t}}var f=(r={},(0,o.default)(r,u.default.COINS.eth,function(t){return"string"==typeof t&&/^0x[A-Fa-f0-9]{40}$/.test(t)}),(0,o.default)(r,u.default.COINS.btc,function(t){return"string"==typeof t&&/^[A-Za-z0-9]{34}$/.test(t)}),(0,o.default)(r,u.default.COINS.nim,function(t){return"string"==typeof t&&/^0x[A-Fa-f0-9]{40}$/.test(t)}),(0,o.default)(r,u.default.COINS.noxon,function(t){return"string"==typeof t&&/^0x[A-Fa-f0-9]{40}$/.test(t)}),(0,o.default)(r,u.default.COINS.swap,function(t){return"string"==typeof t&&/^0x[A-Fa-f0-9]{40}$/.test(t)}),r),l=(i={},(0,o.default)(i,u.default.COINS.eth,"?String"),(0,o.default)(i,u.default.COINS.btc,function(t){return"string"==typeof t&&/^[A-Za-z0-9]{66}$/.test(t)}),(0,o.default)(i,u.default.COINS.nim,"?String"),(0,o.default)(i,u.default.COINS.noxon,"?String"),(0,o.default)(i,u.default.COINS.swap,"?String"),i);e.default={t:a.default,check:function(){try{return a.default.apply(void 0,arguments)}catch(t){return console.error(t),!1}},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isCoinName:function(t){return(0,s.default)(u.default.COINS).map(function(t){return t.toLowerCase()}).includes(t.toLowerCase())},isCoinAddress:f,isPublicKey:l},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(45));e.default=function(t,e,n){return e in t?(0,r.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var r=n(52),i=n(29),o=r.tfJSON,s=r.TfTypeError,a=r.TfPropertyTypeError,u=r.tfSubError,c=r.getValueTypeName,f={arrayOf:function(t){function e(e,n){return!!i.Array(e)&&(!i.Nil(e)&&e.every(function(e,r){try{return h(t,e,n)}catch(t){throw u(t,r)}}))}return t=l(t),e.toJSON=function(){return"["+o(t)+"]"},e},maybe:function t(e){function n(n,r){return i.Nil(n)||e(n,r,t)}return e=l(e),n.toJSON=function(){return"?"+o(e)},n},map:function(t,e){function n(n,r){if(!i.Object(n))return!1;if(i.Nil(n))return!1;for(var o in n){try{e&&h(e,o,r)}catch(t){throw u(t,o,"key")}try{var s=n[o];h(t,s,r)}catch(t){throw u(t,o)}}return!0}return t=l(t),e&&(e=l(e)),n.toJSON=e?function(){return"{"+o(e)+": "+o(t)+"}"}:function(){return"{"+o(t)+"}"},n},object:function(t){var e={};for(var n in t)e[n]=l(t[n]);function r(t,n){if(!i.Object(t))return!1;if(i.Nil(t))return!1;var r;try{for(r in e){h(e[r],t[r],n)}}catch(t){throw u(t,r)}if(n)for(r in t)if(!e[r])throw new a(void 0,r);return!0}return r.toJSON=function(){return o(e)},r},oneOf:function(){var t=[].slice.call(arguments).map(l);function e(e,n){return t.some(function(t){try{return h(t,e,n)}catch(t){return!1}})}return e.toJSON=function(){return t.map(o).join("|")},e},quacksLike:function(t){function e(e){return t===c(e)}return e.toJSON=function(){return t},e},tuple:function(){var t=[].slice.call(arguments).map(l);function e(e,n){return!i.Nil(e)&&(!i.Nil(e.length)&&((!n||e.length===t.length)&&t.every(function(t,r){try{return h(t,e[r],n)}catch(t){throw u(t,r)}})))}return e.toJSON=function(){return"("+t.map(o).join(", ")+")"},e},value:function(t){function e(e){return e===t}return e.toJSON=function(){return t},e}};function l(t){return i.String(t)?"?"===t[0]?f.maybe(t.slice(1)):i[t]||f.quacksLike(t):t&&i.Object(t)?i.Array(t)?f.arrayOf(t[0]):f.object(t):i.Function(t)?t:f.value(t)}function h(t,e,n,r){if(i.Function(t)){if(t(e,n))return!0;throw new s(r||t,e)}return h(l(t),e,n)}for(var d in i)h[d]=i[d];for(d in f)h[d]=f[d];var p=n(96);for(d in p)h[d]=p[d];h.async=function t(e,n,r,i){if("function"==typeof r)return t(e,n,!1,r);try{h(e,n,r)}catch(t){return i(t)}i()},h.compile=l,h.TfTypeError=s,h.TfPropertyTypeError=a,t.exports=h},function(t,e,n){(function(e){var r=n(29),i=n(52);function o(t){return e.isBuffer(t)}function s(t){return"string"==typeof t&&/^([0-9a-f]{2})+$/i.test(t)}function a(t,e){var n=t.toJSON();function r(r){if(!t(r))return!1;if(r.length===e)return!0;throw i.tfCustomError(n+"(Length: "+e+")",n+"(Length: "+r.length+")")}return r.toJSON=function(){return n},r}var u=a.bind(null,r.Array),c=a.bind(null,o),f=a.bind(null,s),l=a.bind(null,r.String),h=Math.pow(2,53)-1;var d={ArrayN:u,Buffer:o,BufferN:c,Finite:function(t){return"number"==typeof t&&isFinite(t)},Hex:s,HexN:f,Int8:function(t){return t<<24>>24===t},Int16:function(t){return t<<16>>16===t},Int32:function(t){return(0|t)===t},StringN:l,UInt8:function(t){return(255&t)===t},UInt16:function(t){return(65535&t)===t},UInt32:function(t){return t>>>0===t},UInt53:function(t){return"number"==typeof t&&t>=0&&t<=h&&Math.floor(t)===t}};for(var p in d)d[p].toJSON=function(t){return t}.bind(null,p);t.exports=d}).call(this,n(27).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),u=0,f=s>0?r-4:r,l=0;l<f;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],a[u++]=e>>16&255,a[u++]=e>>8&255,a[u++]=255&e;2===s&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,a[u++]=255&e);1===s&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,a[u++]=e>>8&255,a[u++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function l(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(f(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,h=n?-1:1,d=t[e+l];for(l+=h,o=d&(1<<-f)-1,d>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*v}},function(t,e,n){"use strict";var r=n(39);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}(t)}},function(t,e,n){"use strict";var r=n(150),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=l;var o=n(141);o.inherits=n(23);var s=n(185),a=n(173);o.inherits(l,s);for(var u=i(a.prototype),c=0;c<u.length;c++){var f=u[c];l.prototype[f]||(l.prototype[f]=a.prototype[f])}function l(t){if(!(this instanceof l))return new l(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),l.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){var r=n(31),i=n(30);t.exports=function(t){return function(e,n){var o,s,a=String(i(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(44),i=n(18),o=n(33),s={};n(12)(s,n(4)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(6),i=n(9),o=n(15);t.exports=n(7)?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),a=s.length,u=0;a>u;)r.f(t,n=s[u++],e[n]);return t}},function(t,e,n){"use strict";var r=n(105),i=n(106),o=n(22),s=n(8);t.exports=n(59)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(2),i=n(11),o=n(7),s=n(5),a=n(65),u=n(124).KEY,c=n(14),f=n(35),l=n(33),h=n(25),d=n(4),p=n(48),v=n(49),w=n(125),y=n(126),g=n(9),_=n(10),b=n(8),m=n(40),S=n(18),x=n(44),E=n(108),k=n(60),T=n(6),O=n(15),A=k.f,M=T.f,P=E.f,N=r.Symbol,C=r.JSON,I=C&&C.stringify,B=d("_hidden"),R=d("toPrimitive"),L={}.propertyIsEnumerable,j=f("symbol-registry"),F=f("symbols"),U=f("op-symbols"),H=Object.prototype,D="function"==typeof N,W=r.QObject,q=!W||!W.prototype||!W.prototype.findChild,V=o&&c(function(){return 7!=x(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=A(H,e);r&&delete H[e],M(t,e,n),r&&t!==H&&M(H,e,r)}:M,K=function(t){var e=F[t]=x(N.prototype);return e._k=t,e},Y=D&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},G=function(t,e,n){return t===H&&G(U,e,n),g(t),e=m(e,!0),g(n),i(F,e)?(n.enumerable?(i(t,B)&&t[B][e]&&(t[B][e]=!1),n=x(n,{enumerable:S(0,!1)})):(i(t,B)||M(t,B,S(1,{})),t[B][e]=!0),V(t,e,n)):M(t,e,n)},z=function(t,e){g(t);for(var n,r=w(e=b(e)),i=0,o=r.length;o>i;)G(t,n=r[i++],e[n]);return t},J=function(t){var e=L.call(this,t=m(t,!0));return!(this===H&&i(F,t)&&!i(U,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,B)&&this[B][t])||e)},$=function(t,e){if(t=b(t),e=m(e,!0),t!==H||!i(F,e)||i(U,e)){var n=A(t,e);return!n||!i(F,e)||i(t,B)&&t[B][e]||(n.enumerable=!0),n}},X=function(t){for(var e,n=P(b(t)),r=[],o=0;n.length>o;)i(F,e=n[o++])||e==B||e==u||r.push(e);return r},Z=function(t){for(var e,n=t===H,r=P(n?U:b(t)),o=[],s=0;r.length>s;)!i(F,e=r[s++])||n&&!i(H,e)||o.push(F[e]);return o};D||(a((N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(n){this===H&&e.call(U,n),i(this,B)&&i(this[B],t)&&(this[B][t]=!1),V(this,t,S(1,n))};return o&&q&&V(H,t,{configurable:!0,set:e}),K(t)}).prototype,"toString",function(){return this._k}),k.f=$,T.f=G,n(67).f=E.f=X,n(19).f=J,n(50).f=Z,o&&!n(17)&&a(H,"propertyIsEnumerable",J,!0),p.f=function(t){return K(d(t))}),s(s.G+s.W+s.F*!D,{Symbol:N});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Q.length>tt;)d(Q[tt++]);for(var et=O(d.store),nt=0;et.length>nt;)v(et[nt++]);s(s.S+s.F*!D,"Symbol",{for:function(t){return i(j,t+="")?j[t]:j[t]=N(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in j)if(j[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!D,"Object",{create:function(t,e){return void 0===e?x(t):z(x(t),e)},defineProperty:G,defineProperties:z,getOwnPropertyDescriptor:$,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),C&&s(s.S+s.F*(!D||c(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(_(e)||void 0!==t)&&!Y(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Y(e))return e}),r[1]=e,I.apply(C,r)}}),N.prototype[R]||n(12)(N.prototype,R,N.prototype.valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,e,n){var r=n(8),i=n(67).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return s.slice()}}(t):i(r(t))}},function(t,e,n){var r;!function(i){"use strict";var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",l=1e14,h=14,d=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,w=1e9;function y(t){var e=0|t;return t>0||t===e?e:e-1}function g(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=h-e.length;n--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function _(t,e){var n,r,i=t.c,o=e.c,s=t.s,a=e.s,u=t.e,c=e.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=u==c,!i||!o)return r?0:!i^n?1:-1;if(!r)return u>c^n?1:-1;for(a=(u=i.length)<(c=o.length)?u:c,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return u==c?0:u>c^n?1:-1}function b(t,e,n,r){if(t<e||t>n||t!==(t<0?a(t):u(t)))throw Error(c+(r||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+t)}function m(t){return"[object Array]"==Object.prototype.toString.call(t)}function S(t){var e=t.c.length-1;return y(t.e/h)==e&&t.c[e]%2!=0}function x(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function E(t,e,n){var r,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(r=t.length)){for(i=n,e-=r;--e;i+=n);t+=i}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(o=function t(e){var n,r,i,o=j.prototype={constructor:j,toString:null,valueOf:null},k=new j(1),T=20,O=4,A=-7,M=21,P=-1e7,N=1e7,C=!1,I=1,B=0,R={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0},L="0123456789abcdefghijklmnopqrstuvwxyz";function j(t,e){var n,o,a,c,l,p,v,w,y=this;if(!(y instanceof j))return new j(t,e);if(null==e){if(t instanceof j)return y.s=t.s,y.e=t.e,void(y.c=(t=t.c)?t.slice():t);if((p="number"==typeof t)&&0*t==0){if(y.s=1/t<0?(t=-t,-1):1,t===~~t){for(c=0,l=t;l>=10;l/=10,c++);return y.e=c,void(y.c=[t])}w=t+""}else{if(!s.test(w=t+""))return i(y,w,p);y.s=45==w.charCodeAt(0)?(w=w.slice(1),-1):1}(c=w.indexOf("."))>-1&&(w=w.replace(".","")),(l=w.search(/e/i))>0?(c<0&&(c=l),c+=+w.slice(l+1),w=w.substring(0,l)):c<0&&(c=w.length)}else{if(b(e,2,L.length,"Base"),w=t+"",10==e)return D(y=new j(t instanceof j?t:w),T+y.e+1,O);if(p="number"==typeof t){if(0*t!=0)return i(y,w,p,e);if(y.s=1/t<0?(w=w.slice(1),-1):1,j.DEBUG&&w.replace(/^0\.0*|\./,"").length>15)throw Error(f+t);p=!1}else y.s=45===w.charCodeAt(0)?(w=w.slice(1),-1):1;for(n=L.slice(0,e),c=l=0,v=w.length;l<v;l++)if(n.indexOf(o=w.charAt(l))<0){if("."==o){if(l>c){c=v;continue}}else if(!a&&(w==w.toUpperCase()&&(w=w.toLowerCase())||w==w.toLowerCase()&&(w=w.toUpperCase()))){a=!0,l=-1,c=0;continue}return i(y,t+"",p,e)}(c=(w=r(w,e,10,y.s)).indexOf("."))>-1?w=w.replace(".",""):c=w.length}for(l=0;48===w.charCodeAt(l);l++);for(v=w.length;48===w.charCodeAt(--v););if(w=w.slice(l,++v)){if(v-=l,p&&j.DEBUG&&v>15&&(t>d||t!==u(t)))throw Error(f+y.s*t);if((c=c-l-1)>N)y.c=y.e=null;else if(c<P)y.c=[y.e=0];else{if(y.e=c,y.c=[],l=(c+1)%h,c<0&&(l+=h),l<v){for(l&&y.c.push(+w.slice(0,l)),v-=h;l<v;)y.c.push(+w.slice(l,l+=h));w=w.slice(l),l=h-w.length}else l-=v;for(;l--;w+="0");y.c.push(+w)}}else y.c=[y.e=0]}function F(t,e,n,r){var i,o,s,a,u;if(null==n?n=O:b(n,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)u=g(t.c),u=1==r||2==r&&s<=A?x(u,s):E(u,s,"0");else if(o=(t=D(new j(t),e,n)).e,a=(u=g(t.c)).length,1==r||2==r&&(e<=o||o<=A)){for(;a<e;u+="0",a++);u=x(u,o)}else if(e-=s,u=E(u,o,"0"),o+1>a){if(--e>0)for(u+=".";e--;u+="0");}else if((e+=o-a)>0)for(o+1==a&&(u+=".");e--;u+="0");return t.s<0&&i?"-"+u:u}function U(t,e){var n,r,i=0;for(m(t[0])&&(t=t[0]),n=new j(t[0]);++i<t.length;){if(!(r=new j(t[i])).s){n=r;break}e.call(n,r)&&(n=r)}return n}function H(t,e,n){for(var r=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,r++);return(n=r+n*h-1)>N?t.c=t.e=null:n<P?t.c=[t.e=0]:(t.e=n,t.c=e),t}function D(t,e,n,r){var i,o,s,c,f,d,v,w=t.c,y=p;if(w){t:{for(i=1,c=w[0];c>=10;c/=10,i++);if((o=e-i)<0)o+=h,s=e,v=(f=w[d=0])/y[i-s-1]%10|0;else if((d=a((o+1)/h))>=w.length){if(!r)break t;for(;w.length<=d;w.push(0));f=v=0,i=1,s=(o%=h)-h+1}else{for(f=c=w[d],i=1;c>=10;c/=10,i++);v=(s=(o%=h)-h+i)<0?0:f/y[i-s-1]%10|0}if(r=r||e<0||null!=w[d+1]||(s<0?f:f%y[i-s-1]),r=n<4?(v||r)&&(0==n||n==(t.s<0?3:2)):v>5||5==v&&(4==n||r||6==n&&(o>0?s>0?f/y[i-s]:0:w[d-1])%10&1||n==(t.s<0?8:7)),e<1||!w[0])return w.length=0,r?(e-=t.e+1,w[0]=y[(h-e%h)%h],t.e=-e||0):w[0]=t.e=0,t;if(0==o?(w.length=d,c=1,d--):(w.length=d+1,c=y[h-o],w[d]=s>0?u(f/y[i-s]%y[s])*c:0),r)for(;;){if(0==d){for(o=1,s=w[0];s>=10;s/=10,o++);for(s=w[0]+=c,c=1;s>=10;s/=10,c++);o!=c&&(t.e++,w[0]==l&&(w[0]=1));break}if(w[d]+=c,w[d]!=l)break;w[d--]=0,c=1}for(o=w.length;0===w[--o];w.pop());}t.e>N?t.c=t.e=null:t.e<P&&(t.c=[t.e=0])}return t}return j.clone=t,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(c+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(b(n=t[e],0,w,e),T=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(b(n=t[e],0,8,e),O=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&(m(n=t[e])?(b(n[0],-w,0,e),b(n[1],0,w,e),A=n[0],M=n[1]):(b(n,-w,w,e),A=-(M=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if(m(n=t[e]))b(n[0],-w,-1,e),b(n[1],1,w,e),P=n[0],N=n[1];else{if(b(n,-w,w,e),!n)throw Error(c+e+" cannot be zero: "+n);P=-(N=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(c+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw C=!n,Error(c+"crypto unavailable");C=n}else C=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(b(n=t[e],0,9,e),I=n),t.hasOwnProperty(e="POW_PRECISION")&&(b(n=t[e],0,w,e),B=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(c+e+" not an object: "+n);R=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|\.|(.).*\1/.test(n))throw Error(c+e+" invalid: "+n);L=n}}return{DECIMAL_PLACES:T,ROUNDING_MODE:O,EXPONENTIAL_AT:[A,M],RANGE:[P,N],CRYPTO:C,MODULO_MODE:I,POW_PRECISION:B,FORMAT:R,ALPHABET:L}},j.isBigNumber=function(t){return t instanceof j||t&&!0===t._isBigNumber||!1},j.maximum=j.max=function(){return U(arguments,o.lt)},j.minimum=j.min=function(){return U(arguments,o.gt)},j.random=function(){var t=9007199254740992*Math.random()&2097151?function(){return u(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,r,i,o,s,f=0,l=[],d=new j(k);if(null==e?e=T:b(e,0,w),o=a(e/h),C)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(o*=2));f<o;)(s=131072*n[f]+(n[f+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),n[f]=r[0],n[f+1]=r[1]):(l.push(s%1e14),f+=2);f=o/2}else{if(!crypto.randomBytes)throw C=!1,Error(c+"crypto unavailable");for(n=crypto.randomBytes(o*=7);f<o;)(s=281474976710656*(31&n[f])+1099511627776*n[f+1]+4294967296*n[f+2]+16777216*n[f+3]+(n[f+4]<<16)+(n[f+5]<<8)+n[f+6])>=9e15?crypto.randomBytes(7).copy(n,f):(l.push(s%1e14),f+=7);f=o/7}if(!C)for(;f<o;)(s=t())<9e15&&(l[f++]=s%1e14);for(o=l[--f],e%=h,o&&e&&(s=p[h-e],l[f]=u(o/s)*s);0===l[f];l.pop(),f--);if(f<0)l=[i=0];else{for(i=-1;0===l[0];l.splice(0,1),i-=h);for(f=1,s=l[0];s>=10;s/=10,f++);f<h&&(i-=h-f)}return d.e=i,d.c=l,d}}(),r=function(){function t(t,e,n,r){for(var i,o,s=[0],a=0,u=t.length;a<u;){for(o=s.length;o--;s[o]*=e);for(s[0]+=r.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(e,r,i,o,s){var a,u,c,f,l,h,d,p,v=e.indexOf("."),w=T,y=O;for(v>=0&&(f=B,B=0,e=e.replace(".",""),h=(p=new j(r)).pow(e.length-v),B=f,p.c=t(E(g(h.c),h.e,"0"),10,i,"0123456789"),p.e=p.c.length),c=f=(d=t(e,r,i,s?(a=L,"0123456789"):(a="0123456789",L))).length;0==d[--f];d.pop());if(!d[0])return a.charAt(0);if(v<0?--c:(h.c=d,h.e=c,h.s=o,d=(h=n(h,p,w,y,i)).c,l=h.r,c=h.e),v=d[u=c+w+1],f=i/2,l=l||u<0||null!=d[u+1],l=y<4?(null!=v||l)&&(0==y||y==(h.s<0?3:2)):v>f||v==f&&(4==y||l||6==y&&1&d[u-1]||y==(h.s<0?8:7)),u<1||!d[0])e=l?E(a.charAt(1),-w,a.charAt(0)):a.charAt(0);else{if(d.length=u,l)for(--i;++d[--u]>i;)d[u]=0,u||(++c,d=[1].concat(d));for(f=d.length;!d[--f];);for(v=0,e="";v<=f;e+=a.charAt(d[v++]));e=E(e,c,a.charAt(0))}return e}}(),n=function(){function t(t,e,n){var r,i,o,s,a=0,u=t.length,c=e%v,f=e/v|0;for(t=t.slice();u--;)a=((i=c*(o=t[u]%v)+(r=f*o+(s=t[u]/v|0)*c)%v*v+a)/n|0)+(r/v|0)+f*s,t[u]=i%n;return a&&(t=[a].concat(t)),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(r,i,o,s,a){var c,f,d,p,v,w,g,_,b,m,S,x,E,k,T,O,A,M=r.s==i.s?1:-1,P=r.c,N=i.c;if(!(P&&P[0]&&N&&N[0]))return new j(r.s&&i.s&&(P?!N||P[0]!=N[0]:N)?P&&0==P[0]||!N?0*M:M/0:NaN);for(b=(_=new j(M)).c=[],M=o+(f=r.e-i.e)+1,a||(a=l,f=y(r.e/h)-y(i.e/h),M=M/h|0),d=0;N[d]==(P[d]||0);d++);if(N[d]>(P[d]||0)&&f--,M<0)b.push(1),p=!0;else{for(k=P.length,O=N.length,d=0,M+=2,(v=u(a/(N[0]+1)))>1&&(N=t(N,v,a),P=t(P,v,a),O=N.length,k=P.length),E=O,S=(m=P.slice(0,O)).length;S<O;m[S++]=0);A=N.slice(),A=[0].concat(A),T=N[0],N[1]>=a/2&&T++;do{if(v=0,(c=e(N,m,O,S))<0){if(x=m[0],O!=S&&(x=x*a+(m[1]||0)),(v=u(x/T))>1)for(v>=a&&(v=a-1),g=(w=t(N,v,a)).length,S=m.length;1==e(w,m,g,S);)v--,n(w,O<g?A:N,g,a),g=w.length,c=1;else 0==v&&(c=v=1),g=(w=N.slice()).length;if(g<S&&(w=[0].concat(w)),n(m,w,S,a),S=m.length,-1==c)for(;e(N,m,O,S)<1;)v++,n(m,O<S?A:N,S,a),S=m.length}else 0===c&&(v++,m=[0]);b[d++]=v,m[0]?m[S++]=P[E]||0:(m=[P[E]],S=1)}while((E++<k||null!=m[0])&&M--);p=null!=m[0],b[0]||b.splice(0,1)}if(a==l){for(d=1,M=b[0];M>=10;M/=10,d++);D(_,o+(_.e=d+f*h-1)+1,s,p)}else _.e=f,_.r=+p;return _}}(),i=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,s,a,u){var f,l=a?s:s.replace(i,"");if(r.test(l))o.s=isNaN(l)?null:l<0?-1:1,o.c=o.e=null;else{if(!a&&(l=l.replace(t,function(t,e,n){return f="x"==(n=n.toLowerCase())?16:"b"==n?2:8,u&&u!=f?t:e}),u&&(f=u,l=l.replace(e,"$1").replace(n,"0.$1")),s!=l))return new j(l,f);if(j.DEBUG)throw Error(c+"Not a"+(u?" base "+u:"")+" number: "+s);o.c=o.e=o.s=null}}}(),o.absoluteValue=o.abs=function(){var t=new j(this);return t.s<0&&(t.s=1),t},o.comparedTo=function(t,e){return _(this,new j(t,e))},o.decimalPlaces=o.dp=function(t,e){var n,r,i,o=this;if(null!=t)return b(t,0,w),null==e?e=O:b(e,0,8),D(new j(o),t+o.e+1,e);if(!(n=o.c))return null;if(r=((i=n.length-1)-y(this.e/h))*h,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},o.dividedBy=o.div=function(t,e){return n(this,new j(t,e),T,O)},o.dividedToIntegerBy=o.idiv=function(t,e){return n(this,new j(t,e),0,1)},o.exponentiatedBy=o.pow=function(t,e){var n,r,i,o,s,f,l,d=this;if((t=new j(t)).c&&!t.isInteger())throw Error(c+"Exponent not an integer: "+t);if(null!=e&&(e=new j(e)),o=t.e>14,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!t.c||!t.c[0])return l=new j(Math.pow(+d.valueOf(),o?2-S(t):+t)),e?l.mod(e):l;if(s=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new j(NaN);(r=!s&&d.isInteger()&&e.isInteger())&&(d=d.mod(e))}else{if(t.e>9&&(d.e>0||d.e<-1||(0==d.e?d.c[0]>1||o&&d.c[1]>=24e7:d.c[0]<8e13||o&&d.c[0]<=9999975e7)))return i=d.s<0&&S(t)?-0:0,d.e>-1&&(i=1/i),new j(s?1/i:i);B&&(i=a(B/h+2))}for(o?(n=new j(.5),f=S(t)):f=t%2,s&&(t.s=1),l=new j(k);;){if(f){if(!(l=l.times(d)).c)break;i?l.c.length>i&&(l.c.length=i):r&&(l=l.mod(e))}if(o){if(D(t=t.times(n),t.e+1,1),!t.c[0])break;o=t.e>14,f=S(t)}else{if(!(t=u(t/2)))break;f=t%2}d=d.times(d),i?d.c&&d.c.length>i&&(d.c.length=i):r&&(d=d.mod(e))}return r?l:(s&&(l=k.div(l)),e?l.mod(e):i?D(l,B,O,void 0):l)},o.integerValue=function(t){var e=new j(this);return null==t?t=O:b(t,0,8),D(e,e.e+1,t)},o.isEqualTo=o.eq=function(t,e){return 0===_(this,new j(t,e))},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(t,e){return _(this,new j(t,e))>0},o.isGreaterThanOrEqualTo=o.gte=function(t,e){return 1===(e=_(this,new j(t,e)))||0===e},o.isInteger=function(){return!!this.c&&y(this.e/h)>this.c.length-2},o.isLessThan=o.lt=function(t,e){return _(this,new j(t,e))<0},o.isLessThanOrEqualTo=o.lte=function(t,e){return-1===(e=_(this,new j(t,e)))||0===e},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&0==this.c[0]},o.minus=function(t,e){var n,r,i,o,s=this,a=s.s;if(e=(t=new j(t,e)).s,!a||!e)return new j(NaN);if(a!=e)return t.s=-e,s.plus(t);var u=s.e/h,c=t.e/h,f=s.c,d=t.c;if(!u||!c){if(!f||!d)return f?(t.s=-e,t):new j(d?s:NaN);if(!f[0]||!d[0])return d[0]?(t.s=-e,t):new j(f[0]?s:3==O?-0:0)}if(u=y(u),c=y(c),f=f.slice(),a=u-c){for((o=a<0)?(a=-a,i=f):(c=u,i=d),i.reverse(),e=a;e--;i.push(0));i.reverse()}else for(r=(o=(a=f.length)<(e=d.length))?a:e,a=e=0;e<r;e++)if(f[e]!=d[e]){o=f[e]<d[e];break}if(o&&(i=f,f=d,d=i,t.s=-t.s),(e=(r=d.length)-(n=f.length))>0)for(;e--;f[n++]=0);for(e=l-1;r>a;){if(f[--r]<d[r]){for(n=r;n&&!f[--n];f[n]=e);--f[n],f[r]+=l}f[r]-=d[r]}for(;0==f[0];f.splice(0,1),--c);return f[0]?H(t,f,c):(t.s=3==O?-1:1,t.c=[t.e=0],t)},o.modulo=o.mod=function(t,e){var r,i,o=this;return t=new j(t,e),!o.c||!t.s||t.c&&!t.c[0]?new j(NaN):!t.c||o.c&&!o.c[0]?new j(o):(9==I?(i=t.s,t.s=1,r=n(o,t,0,3),t.s=i,r.s*=i):r=n(o,t,0,I),(t=o.minus(r.times(t))).c[0]||1!=I||(t.s=o.s),t)},o.multipliedBy=o.times=function(t,e){var n,r,i,o,s,a,u,c,f,d,p,w,g,_,b,m=this,S=m.c,x=(t=new j(t,e)).c;if(!(S&&x&&S[0]&&x[0]))return!m.s||!t.s||S&&!S[0]&&!x||x&&!x[0]&&!S?t.c=t.e=t.s=null:(t.s*=m.s,S&&x?(t.c=[0],t.e=0):t.c=t.e=null),t;for(r=y(m.e/h)+y(t.e/h),t.s*=m.s,(u=S.length)<(d=x.length)&&(g=S,S=x,x=g,i=u,u=d,d=i),i=u+d,g=[];i--;g.push(0));for(_=l,b=v,i=d;--i>=0;){for(n=0,p=x[i]%b,w=x[i]/b|0,o=i+(s=u);o>i;)n=((c=p*(c=S[--s]%b)+(a=w*c+(f=S[s]/b|0)*p)%b*b+g[o]+n)/_|0)+(a/b|0)+w*f,g[o--]=c%_;g[o]=n}return n?++r:g.splice(0,1),H(t,g,r)},o.negated=function(){var t=new j(this);return t.s=-t.s||null,t},o.plus=function(t,e){var n,r=this,i=r.s;if(e=(t=new j(t,e)).s,!i||!e)return new j(NaN);if(i!=e)return t.s=-e,r.minus(t);var o=r.e/h,s=t.e/h,a=r.c,u=t.c;if(!o||!s){if(!a||!u)return new j(i/0);if(!a[0]||!u[0])return u[0]?t:new j(a[0]?r:0*i)}if(o=y(o),s=y(s),a=a.slice(),i=o-s){for(i>0?(s=o,n=u):(i=-i,n=a),n.reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(e=u.length)<0&&(n=u,u=a,a=n,e=i),i=0;e;)i=(a[--e]=a[e]+u[e]+i)/l|0,a[e]=l===a[e]?0:a[e]%l;return i&&(a=[i].concat(a),++s),H(t,a,s)},o.precision=o.sd=function(t,e){var n,r,i,o=this;if(null!=t&&t!==!!t)return b(t,1,w),null==e?e=O:b(e,0,8),D(new j(o),t,e);if(!(n=o.c))return null;if(r=(i=n.length-1)*h+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return t&&o.e+1>r&&(r=o.e+1),r},o.shiftedBy=function(t){return b(t,-d,d),this.times("1e"+t)},o.squareRoot=o.sqrt=function(){var t,e,r,i,o,s=this,a=s.c,u=s.s,c=s.e,f=T+4,l=new j("0.5");if(1!==u||!a||!a[0])return new j(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);if(0==(u=Math.sqrt(+s))||u==1/0?(((e=g(a)).length+c)%2==0&&(e+="0"),u=Math.sqrt(e),c=y((c+1)/2)-(c<0||c%2),r=new j(e=u==1/0?"1e"+c:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+c)):r=new j(u+""),r.c[0])for((u=(c=r.e)+f)<3&&(u=0);;)if(o=r,r=l.times(o.plus(n(s,o,f,1))),g(o.c).slice(0,u)===(e=g(r.c)).slice(0,u)){if(r.e<c&&--u,"9999"!=(e=e.slice(u-3,u+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(D(r,r.e+T+2,1),t=!r.times(r).eq(s));break}if(!i&&(D(o,o.e+T+2,0),o.times(o).eq(s))){r=o;break}f+=4,u+=4,i=1}return D(r,r.e+T+1,O,t)},o.toExponential=function(t,e){return null!=t&&(b(t,0,w),t++),F(this,t,e,1)},o.toFixed=function(t,e){return null!=t&&(b(t,0,w),t=t+this.e+1),F(this,t,e)},o.toFormat=function(t,e){var n=this.toFixed(t,e);if(this.c){var r,i=n.split("."),o=+R.groupSize,s=+R.secondaryGroupSize,a=R.groupSeparator,u=i[0],c=i[1],f=this.s<0,l=f?u.slice(1):u,h=l.length;if(s&&(r=o,o=s,s=r,h-=r),o>0&&h>0){for(r=h%o||o,u=l.substr(0,r);r<h;r+=o)u+=a+l.substr(r,o);s>0&&(u+=a+l.slice(r)),f&&(u="-"+u)}n=c?u+R.decimalSeparator+((s=+R.fractionGroupSize)?c.replace(new RegExp("\\d{"+s+"}\\B","g"),"$&"+R.fractionGroupSeparator):c):u}return n},o.toFraction=function(t){var e,r,i,o,s,a,u,f,l,d,v,w,y=this,_=y.c;if(null!=t&&(!(f=new j(t)).isInteger()&&(f.c||1!==f.s)||f.lt(k)))throw Error(c+"Argument "+(f.isInteger()?"out of range: ":"not an integer: ")+t);if(!_)return y.toString();for(r=new j(k),d=i=new j(k),o=l=new j(k),w=g(_),a=r.e=w.length-y.e-1,r.c[0]=p[(u=a%h)<0?h+u:u],t=!t||f.comparedTo(r)>0?a>0?r:d:f,u=N,N=1/0,f=new j(w),l.c[0]=0;v=n(f,r,0,1),1!=(s=i.plus(v.times(o))).comparedTo(t);)i=o,o=s,d=l.plus(v.times(s=d)),l=s,r=f.minus(v.times(s=r)),f=s;return s=n(t.minus(i),o,0,1),l=l.plus(s.times(d)),i=i.plus(s.times(o)),l.s=d.s=y.s,e=n(d,o,a*=2,O).minus(y).abs().comparedTo(n(l,i,a,O).minus(y).abs())<1?[d.toString(),o.toString()]:[l.toString(),i.toString()],N=u,e},o.toNumber=function(){return+this},o.toPrecision=function(t,e){return null!=t&&b(t,1,w),F(this,t,e,2)},o.toString=function(t){var e,n=this,i=n.s,o=n.e;return null===o?i?(e="Infinity",i<0&&(e="-"+e)):e="NaN":(e=g(n.c),null==t?e=o<=A||o>=M?x(e,o):E(e,o,"0"):(b(t,2,L.length,"Base"),e=r(E(e,o,"0"),10,t,i,!0)),i<0&&n.c[0]&&(e="-"+e)),e},o.valueOf=o.toJSON=function(){var t,e=this,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=A||n>=M?x(t,n):E(t,n,"0"),e.s<0?"-"+t:t)},o._isBigNumber=!0,null!=e&&j.set(e),j}()).default=o.BigNumber=o,void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){var r=n(24),i=n(4)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){t.exports={default:n(160),__esModule:!0}},function(t,e,n){var r=n(41).Buffer;function i(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}i.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var n=this._block,i=this._blockSize,o=t.length,s=this._len,a=0;a<o;){for(var u=s%i,c=Math.min(o-a,i-u),f=0;f<c;f++)n[u+f]=t[a+f];a+=c,(s+=c)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return t?o.toString(t):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},function(t,e,n){var r=n(9);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(22),i=n(4)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){var r=n(110),i=n(4)("iterator"),o=n(22);t.exports=n(0).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(4)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(t){}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Flow=void 0;var r=o(n(191)),i=o(n(192));function o(t){return t&&t.__esModule?t:{default:t}}e.default=r.default,e.Flow=i.default},function(t,e,n){n(119),t.exports=n(0).Object.getPrototypeOf},function(t,e,n){var r=n(20),i=n(64);n(42)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){t.exports={default:n(121),__esModule:!0}},function(t,e,n){n(58),n(69),t.exports=n(48).f("iterator")},function(t,e,n){t.exports={default:n(123),__esModule:!0}},function(t,e,n){n(107),n(70),n(127),n(128),t.exports=n(0).Symbol},function(t,e,n){var r=n(25)("meta"),i=n(10),o=n(11),s=n(6).f,a=0,u=Object.isExtensible||function(){return!0},c=!n(14)(function(){return u(Object.preventExtensions({}))}),f=function(t){s(t,r,{value:{i:"O"+ ++a,w:{}}})},l=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";f(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;f(t)}return t[r].w},onFreeze:function(t){return c&&l.NEED&&u(t)&&!o(t,r)&&f(t),t}}},function(t,e,n){var r=n(15),i=n(50),o=n(19);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var s,a=n(t),u=o.f,c=0;a.length>c;)u.call(t,s=a[c++])&&e.push(s);return e}},function(t,e,n){var r=n(24);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){n(49)("asyncIterator")},function(t,e,n){n(49)("observable")},function(t,e,n){t.exports={default:n(130),__esModule:!0}},function(t,e,n){n(131),t.exports=n(0).Object.setPrototypeOf},function(t,e,n){var r=n(5);r(r.S,"Object",{setPrototypeOf:n(132).set})},function(t,e,n){var r=n(10),i=n(9),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(21)(Function.call,n(60).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){t.exports={default:n(134),__esModule:!0}},function(t,e,n){n(135);var r=n(0).Object;t.exports=function(t,e){return r.create(t,e)}},function(t,e,n){var r=n(5);r(r.S,"Object",{create:n(44)})},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}},function(t,e,n){var r=n(9),i=n(39),o=n(4)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||void 0==(n=r(s)[o])?e:i(n)}},function(t,e,n){var r,i,o,s=n(21),a=n(164),u=n(66),c=n(43),f=n(2),l=f.process,h=f.setImmediate,d=f.clearImmediate,p=f.MessageChannel,v=f.Dispatch,w=0,y={},g=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},_=function(t){g.call(t.data)};h&&d||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++w]=function(){a("function"==typeof t?t:Function(t),e)},r(w),w},d=function(t){delete y[t]},"process"==n(24)(l)?r=function(t){l.nextTick(s(g,t,1))}:v&&v.now?r=function(t){v.now(s(g,t,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,r=s(o.postMessage,o,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(t){f.postMessage(t+"","*")},f.addEventListener("message",_,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),g.call(t)}}:function(t){setTimeout(s(g,t,1),0)}),t.exports={set:h,clear:d}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(9),i=n(10),o=n(99);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(27).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(153));e.default=r.default,t.exports=e.default},function(t,e,n){t.exports={default:n(144),__esModule:!0}},function(t,e,n){n(145),t.exports=n(0).Object.assign},function(t,e,n){var r=n(5);r(r.S+r.F,"Object",{assign:n(146)})},function(t,e,n){"use strict";var r=n(15),i=n(50),o=n(19),s=n(20),a=n(57),u=Object.assign;t.exports=!u||n(14)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=s(t),u=arguments.length,c=1,f=i.f,l=o.f;u>c;)for(var h,d=a(arguments[c++]),p=f?r(d).concat(f(d)):r(d),v=p.length,w=0;v>w;)l.call(d,h=p[w++])&&(n[h]=d[h]);return n}:u},function(t,e,n){"use strict";e.__esModule=!0;var r=o(n(32)),i=o(n(176));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function t(e,n,o){null===e&&(e=Function.prototype);var s=(0,i.default)(e,n);if(void 0===s){var a=(0,r.default)(e);return null===a?void 0:t(a,n,o)}if("value"in s)return s.value;var u=s.get;return void 0!==u?u.call(o):void 0}},function(t,e,n){var r=n(205);function i(t){return r("rmd160").update(t).digest()}function o(t){return r("sha256").update(t).digest()}t.exports={hash160:function(t){return i(o(t))},hash256:function(t){return o(o(t))},ripemd160:i,sha1:function(t){return r("sha1").update(t).digest()},sha256:o}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!f){var t=a(h);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||f||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(149))},function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(154));e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,r.default)(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(61)),i=u(n(136)),o=u(n(1)),s=u(n(3)),a=u(n(16));function u(t){return t&&t.__esModule?t:{default:t}}var c=function(){function t(e){var n=e.swapId,r=e.participantPeer;(0,o.default)(this,t),this.swapId=n,this.peer=r}return(0,s.default)(t,[{key:"on",value:function(t,e){var n=this;a.default.services.room.on(t,function(r){var o=r.fromPeer,s=r.swapId,a=(0,i.default)(r,["fromPeer","swapId"]);console.log("on "+t+" from "+o+" at swap "+s,a),o===n.peer&&s===n.swapId&&e(a)})}},{key:"once",value:function(t,e){var n=this;a.default.services.room.on(t,function(r){var o=r.fromPeer,s=r.swapId,a=(0,i.default)(r,["fromPeer","swapId"]);console.log("once "+t+" from "+o+" at swap "+s,a),o===n.peer&&s===n.swapId&&(this.unsubscribe(),e(a))})}},{key:"sendMessage",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(console.log("send message",e),1===e.length){var i=e[0];if("string"==typeof i)a.default.services.room.sendMessage(this.peer,[{event:i,data:{swapId:this.swapId}}]);else if(Array.isArray(i)){if(i[0]&&!i[0].swapId)throw console.error("Bad format",i[0]),new Error("Bad message format! "+i[0]);a.default.services.room.sendMessage(this.peer,i)}}else{var o=e[0],s=e[1];a.default.services.room.sendMessage(this.peer,[{event:o,data:(0,r.default)({swapId:this.swapId},s)}])}}}]),t}();e.default=c,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(56)),i=h(n(13)),o=h(n(32)),s=h(n(1)),a=h(n(37)),u=h(n(3)),c=h(n(38)),f=n(16),l=h(f);function h(t){return t&&t.__esModule?t:{default:t}}var d=void 0,p={},v=function(t){function e(t){(0,s.default)(this,e);var n=(0,a.default)(this,(e.__proto__||(0,o.default)(e)).call(this));return n._serviceName="auth",n.accounts={},d=t,n}return(0,c.default)(e,t),(0,u.default)(e,null,[{key:"name",get:function(){return"auth"}}]),(0,u.default)(e,[{key:"initService",value:function(){var t=this;(0,i.default)(d).forEach(function(e){if((0,i.default)(f.constants.COINS).indexOf(e)<0){var o='SwapAuth._initService(): There is no instance with name "'+e+'".';throw o+="Only ["+(0,r.default)((0,i.default)(f.constants.COINS)).replace(/"/g,"'")+"] available",new Error(o)}try{var s=n(193)("./"+e),a=(s=s.default||s).login(d[e]);t.accounts[e]=a,p[e]=function(){return s.getPublicData(a)}}catch(t){throw new Error("SwapAuth._initService(): "+t)}})}},{key:"getPublicData",value:function(){var t={peer:l.default.services.room.peer};return(0,i.default)(p).forEach(function(e){t[e]=p[e]()}),t}}]),e}(f.ServiceInterface);e.default=v,t.exports=e.default},function(t,e,n){t.exports={default:n(155),__esModule:!0}},function(t,e,n){n(58),n(156),t.exports=n(0).Array.from},function(t,e,n){"use strict";var r=n(21),i=n(5),o=n(20),s=n(113),a=n(114),u=n(47),c=n(157),f=n(115);i(i.S+i.F*!n(116)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,l,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,w=void 0!==v,y=0,g=f(h);if(w&&(v=r(v,p>2?arguments[2]:void 0,2)),void 0==g||d==Array&&a(g))for(n=new d(e=u(h.length));e>y;y++)c(n,y,w?v(h[y],y):h[y]);else for(l=g.call(h),n=new d;!(i=l.next()).done;y++)c(n,y,w?s(l,v,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){"use strict";var r=n(6),i=n(18);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(159),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"==typeof t,f=e.regeneratorRuntime;if(f)c&&(t.exports=f);else{(f=e.regeneratorRuntime=c?t.exports:{}).wrap=b;var l="suspendedStart",h="suspendedYield",d="executing",p="completed",v={},w={};w[s]=function(){return this};var y=Object.getPrototypeOf,g=y&&y(y(N([])));g&&g!==r&&i.call(g,s)&&(w=g);var _=E.prototype=S.prototype=Object.create(w);x.prototype=_.constructor=E,E.constructor=x,E[u]=x.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(_),t},f.awrap=function(t){return{__await:t}},k(T.prototype),T.prototype[a]=function(){return this},f.AsyncIterator=T,f.async=function(t,e,n,r){var i=new T(b(t,e,n,r));return f.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},k(_),_[u]="Generator",_[s]=function(){return this},_.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return a.type="throw",a.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function b(t,e,n,r){var i=e&&e.prototype instanceof S?e:S,o=Object.create(i.prototype),s=new P(r||[]);return o._invoke=function(t,e,n){var r=l;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=O(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=m(t,e,n);if("normal"===u.type){if(r=n.done?p:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function m(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function S(){}function x(){}function E(){}function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function T(t){var e;this._invoke=function(n,r){function o(){return new Promise(function(e,o){!function e(n,r,o,s){var a=m(t[n],t,r);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,s)},function(t){e("throw",t,o,s)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},s)}s(a.arg)}(n,r,e,o)})}return e=e?e.then(o,o):o()}}function O(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,O(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=m(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function N(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e,n){n(70),n(58),n(69),n(161),n(169),n(170),t.exports=n(0).Promise},function(t,e,n){"use strict";var r,i,o,s,a=n(17),u=n(2),c=n(21),f=n(110),l=n(5),h=n(10),d=n(39),p=n(162),v=n(163),w=n(137),y=n(138).set,g=n(165)(),_=n(99),b=n(139),m=n(166),S=n(140),x=u.TypeError,E=u.process,k=E&&E.versions,T=k&&k.v8||"",O=u.Promise,A="process"==f(E),M=function(){},P=i=_.f,N=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[n(4)("species")]=function(t){t(M,M)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(M)instanceof e&&0!==T.indexOf("6.6")&&-1===m.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},I=function(t,e){if(!t._n){t._n=!0;var n=t._c;g(function(){for(var r=t._v,i=1==t._s,o=0,s=function(e){var n,o,s,a=i?e.ok:e.fail,u=e.resolve,c=e.reject,f=e.domain;try{a?(i||(2==t._h&&L(t),t._h=1),!0===a?n=r:(f&&f.enter(),n=a(r),f&&(f.exit(),s=!0)),n===e.promise?c(x("Promise-chain cycle")):(o=C(n))?o.call(n,u,c):u(n)):c(r)}catch(t){f&&!s&&f.exit(),c(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&B(t)})}},B=function(t){y.call(u,function(){var e,n,r,i=t._v,o=R(t);if(o&&(e=b(function(){A?E.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=A||R(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},R=function(t){return 1!==t._h&&0===(t._a||t._c).length},L=function(t){y.call(u,function(){var e;A?E.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},j=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),I(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw x("Promise can't be resolved itself");(e=C(t))?g(function(){var r={_w:n,_d:!1};try{e.call(t,c(F,r,1),c(j,r,1))}catch(t){j.call(r,t)}}):(n._v=t,n._s=1,I(n,!1))}catch(t){j.call({_w:n,_d:!1},t)}}};N||(O=function(t){p(this,O,"Promise","_h"),d(t),r.call(this);try{t(c(F,this,1),c(j,this,1))}catch(t){j.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(167)(O.prototype,{then:function(t,e){var n=P(w(this,O));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=A?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&I(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(F,t,1),this.reject=c(j,t,1)},_.f=P=function(t){return t===O||t===s?new o(t):i(t)}),l(l.G+l.W+l.F*!N,{Promise:O}),n(33)(O,"Promise"),n(168)("Promise"),s=n(0).Promise,l(l.S+l.F*!N,"Promise",{reject:function(t){var e=P(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(a||!N),"Promise",{resolve:function(t){return S(a&&this===s?O:this,t)}}),l(l.S+l.F*!(N&&n(116)(function(t){O.all(t).catch(M)})),"Promise",{all:function(t){var e=this,n=P(e),r=n.resolve,i=n.reject,o=b(function(){var n=[],o=0,s=1;v(t,!1,function(t){var a=o++,u=!1;n.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,n[a]=t,--s||r(n))},i)}),--s||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=P(e),r=n.reject,i=b(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(21),i=n(113),o=n(114),s=n(9),a=n(47),u=n(115),c={},f={};(e=t.exports=function(t,e,n,l,h){var d,p,v,w,y=h?function(){return t}:u(t),g=r(n,l,e?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(d=a(t.length);d>_;_++)if((w=e?g(s(p=t[_])[0],p[1]):g(t[_]))===c||w===f)return w}else for(v=y.call(t);!(p=v.next()).done;)if((w=i(v,g,p.value,e))===c||w===f)return w}).BREAK=c,e.RETURN=f},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(2),i=n(138).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(24)(s);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=s.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var f=a.resolve(void 0);n=function(){f.then(c)}}else n=function(){i.call(r,c)};else{var l=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=l=!l}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){var r=n(2).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){var r=n(12);t.exports=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:r(t,i,e[i]);return t}},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(6),s=n(7),a=n(4)("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:r[t];s&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";var r=n(5),i=n(0),o=n(2),s=n(137),a=n(140);r(r.P+r.R,"Promise",{finally:function(t){var e=s(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then(function(){return n})}:t,n?function(n){return a(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(5),i=n(99),o=n(139);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(o(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,u=0;u<s;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(t,e){var s;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,o,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(e=t.exports=n(185)).Stream=e,e.Readable=e,e.Writable=n(173),e.Duplex=n(100),e.Transform=n(188),e.PassThrough=n(213)},function(t,e,n){"use strict";(function(e,r,i){var o=n(150);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=g;var a,u=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;g.WritableState=y;var c=n(141);c.inherits=n(23);var f={deprecate:n(212)},l=n(186),h=n(41).Buffer,d=i.Uint8Array||function(){};var p,v=n(187);function w(){}function y(t,e){a=a||n(100),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,c=t.writableHighWaterMark,f=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(c||0===c)?c:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(E,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),E(t,e))}(t,n,r,e,i);else{var s=S(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||m(t,n),r?u(b,t,n,s,i):b(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function g(t){if(a=a||n(100),!(p.call(g,this)||this instanceof a))return new g(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function _(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function b(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),E(t,e)}function m(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var a=0,u=!0;n;)i[a]=n,n.isBuf||(u=!1),n=n.next,a+=1;i.allBuffers=u,_(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,f=n.encoding,l=n.callback;if(_(t,e,!1,e.objectMode?1:c.length,c,f,l),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function S(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function x(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),E(t,e)})}function E(t,e){var n=S(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(x,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}c.inherits(g,l),y.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(y.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(t){return!!p.call(this,t)||this===g&&(t&&t._writableState instanceof y)}})):p=function(t){return t instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(t,e,n){var r=this._writableState,i=!1,s=!r.objectMode&&function(t){return h.isBuffer(t)||t instanceof d}(t);return s&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=w),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),o.nextTick(r,s),i=!1),i}(this,r,t,n))&&(r.pendingcb++,i=function(t,e,n,r,i,o){if(!n){var s=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n));return e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var u=e.length<e.highWaterMark;u||(e.needDrain=!0);if(e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else _(t,e,!1,a,r,i,o);return u}(this,r,s,t,e,n)),i},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||m(this,t))},g.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,E(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),g.prototype.destroy=v.destroy,g.prototype._undestroy=v.undestroy,g.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(149),n(210).setImmediate,n(26))},function(t,e,n){"use strict";var r=n(41).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=f,this.end=l,e=3;break;default:return this.write=h,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function f(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(179));e.default=r.default,t.exports=e.default},function(t,e,n){t.exports={default:n(180),__esModule:!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(16));e.default={login:function(t){var e=r.default.network+":btc:privateKey",n=t||r.default.env.storage.getItem(e),i=void 0,o=r.default.isMainNet()?r.default.env.bitcoin.networks.bitcoin:r.default.env.bitcoin.networks.testnet;return n||(n=r.default.env.bitcoin.ECPair.makeRandom({network:o}).toWIF()),(i=new r.default.env.bitcoin.ECPair.fromWIF(n,o)).__proto__.getPublicKey=function(){return i.getPublicKeyBuffer().toString("hex")},i.__proto__.getPrivateKey=function(){return n},t||r.default.env.storage.setItem(e,n),i},getPublicData:function(t){return{address:t.getAddress(),publicKey:t.getPublicKey()}}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(16));e.default={login:function(t){var e=r.default.network+":eth:privateKey",n=t||r.default.env.storage.getItem(e),i=void 0;return i=n?r.default.env.web3.eth.accounts.privateKeyToAccount(n):r.default.env.web3.eth.accounts.create(),r.default.env.web3.eth.accounts.wallet.add(i.privateKey),t||r.default.env.storage.setItem(e,i.privateKey),i},getPublicData:function(t){return{address:t.address,publicKey:null}}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=d(n(56)),i=d(n(53)),o=d(n(61)),s=d(n(32)),a=d(n(1)),u=d(n(37)),c=d(n(3)),f=d(n(38)),l=n(16),h=d(l);function d(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(t){(0,a.default)(this,e);var n=(0,u.default)(this,(e.__proto__||(0,s.default)(e)).call(this));if(n._handleUserOnline=function(t){t!==n.peer&&n._events.dispatch("user online",t)},n._handleUserOffline=function(t){t!==n.peer&&n._events.dispatch("user offline",t)},n._handleNewMessage=function(t){var e=t.from,r=t.data;if(e!==n.peer){var i=void 0;try{i=JSON.parse(r.toString())}catch(t){console.error("parse message data err:",t)}var s=i,a=s.fromAddress,u=s.messages,c=s.sign,f=n._recoverMessage(u,c);f===a?u&&u.length&&u.forEach(function(t){var r=t.event,i=t.data;n._events.dispatch(r,(0,o.default)({fromPeer:e},i||{}))}):console.error("Wrong message sign! Message from: "+a+", recover: "+f)}},!t||"object"!==(void 0===t?"undefined":(0,i.default)(t)))throw new Error('SwapRoomService: "config" of type object required');return n._serviceName="room",n._config=t,n._events=new l.Events,n.peer=null,n.connection=null,n.roomName=null,n}return(0,f.default)(e,t),(0,c.default)(e,null,[{key:"name",get:function(){return"room"}}]),(0,c.default)(e,[{key:"initService",value:function(){var t=this;if(!h.default.env.Ipfs)throw new Error("SwapRoomService: Ipfs required");if(!h.default.env.IpfsRoom)throw new Error("SwapRoomService: IpfsRoom required");var e=new h.default.env.Ipfs(this._config);e.once("error",function(t){console.log("IPFS error!",t)}),e.once("ready",function(){return e.id(function(n,r){if(console.info("IPFS ready!"),n)throw n;t._init({peer:r.id,ipfsConnection:e})})})}},{key:"_init",value:function(t){var e=t.peer,n=t.ipfsConnection;this.peer=e,this.roomName=h.default.isMainNet()?"swap.online":"testnet.swap.online",console.log("Using room: "+this.roomName),this.connection=h.default.env.IpfsRoom(n,this.roomName,{pollInterval:5e3}),this.connection.on("peer joined",this._handleUserOnline),this.connection.on("peer left",this._handleUserOffline),this.connection.on("message",this._handleNewMessage),this._events.dispatch("ready")}},{key:"on",value:function(t,e){this._events.subscribe(t,e)}},{key:"off",value:function(t,e){this._events.unsubscribe(t,e)}},{key:"once",value:function(t,e){this._events.once(t,e)}},{key:"_recoverMessage",value:function(t,e){var n=h.default.env.web3.utils.soliditySha3((0,r.default)(t));return h.default.env.web3.eth.accounts.recover(n,e.signature)}},{key:"_signMessage",value:function(t){var e=h.default.env.web3.utils.soliditySha3((0,r.default)(t));return h.default.env.web3.eth.accounts.sign(e,h.default.services.auth.accounts.eth.privateKey)}},{key:"sendMessage",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(1===e.length){var i=e[0],o=this._signMessage(i);this.connection.broadcast((0,r.default)({fromAddress:h.default.services.auth.accounts.eth.address,messages:i,sign:o}))}else{var s=e[0],a=e[1],u=this._signMessage(a);this.connection.sendTo(s,(0,r.default)({fromAddress:h.default.services.auth.accounts.eth.address,messages:a,sign:u}))}}}]),e}(l.ServiceInterface);e.default=p,t.exports=e.default},function(t,e,n){n(181);var r=n(0).Object;t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)}},function(t,e,n){var r=n(8),i=n(60).f;n(42)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(16);e.default=new r.Events,t.exports=e.default},function(t,e,n){"use strict";var r=n(41).Buffer,i=n(184).Transform;function o(t){i.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(23)(o,i),o.prototype._transform=function(t,e,n){var r=null;try{this.update(t,e)}catch(t){r=t}n(r)},o.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},o.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError(e+" must be a string or a buffer")}(t,"Data"),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var n=this._block,i=0;this._blockOffset+t.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=t[i++];this._update(),this._blockOffset=0}for(;i<t.length;)n[this._blockOffset++]=t[i++];for(var s=0,a=8*t.length;a>0;++s)this._length[s]+=a,(a=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*a);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return e},o.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=o},function(t,e,n){t.exports=i;var r=n(171).EventEmitter;function i(){r.call(this)}n(23)(i,r),i.Readable=n(172),i.Writable=n(214),i.Duplex=n(215),i.Transform=n(216),i.PassThrough=n(217),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",u));var s=!1;function a(){s||(s=!0,t.end())}function u(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(f(),0===r.listenerCount(this,"error"))throw t}function f(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",u),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",f),n.removeListener("close",f),t.removeListener("close",f)}return n.on("error",c),t.on("error",c),n.on("end",f),n.on("close",f),t.on("close",f),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e,r){var i=n(150);t.exports=_;var o,s=n(68);_.ReadableState=g;n(171).EventEmitter;var a=function(t,e){return t.listeners(e).length},u=n(186),c=n(41).Buffer,f=e.Uint8Array||function(){};var l=n(141);l.inherits=n(23);var h=n(207),d=void 0;d=h&&h.debuglog?h.debuglog("stream"):function(){};var p,v=n(208),w=n(187);l.inherits(_,u);var y=["error","close","destroy","pause","resume"];function g(t,e){o=o||n(100),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=n(174).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function _(t){if(o=o||n(100),!(this instanceof _))return new _(t);this._readableState=new g(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function b(t,e,n,r,i){var o,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,E(t)}(t,s)):(i||(o=function(t,e){var n;(function(t){return c.isBuffer(t)||t instanceof f})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=function(t){return c.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):m(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?m(t,s,e,!1):T(t,s)):m(t,s,e,!1))):r||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function m(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&E(t)),T(t,e)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),_.prototype.destroy=w.destroy,_.prototype._undestroy=w.undestroy,_.prototype._destroy=function(t,e){this.push(null),e(t)},_.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=c.from(t,e),e=""),n=!0),b(this,t,e,!1,n)},_.prototype.unshift=function(t){return b(this,t,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(t){return p||(p=n(174).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var S=8388608;function x(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=S?t=S:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function E(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(d("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(k,t):k(t))}function k(t){d("emit readable"),t.emit("readable"),P(t)}function T(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(O,t,e))}function O(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(d("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function A(t){d("readable nexttick read 0"),t.read(0)}function M(t,e){e.reading||(d("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),P(t),e.flowing&&!e.reading&&t.read(0)}function P(t){var e=t._readableState;for(d("flow",e.flowing);e.flowing&&null!==t.read(););}function N(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=c.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function C(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(I,e,t))}function I(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function B(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}_.prototype.read=function(t){d("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return d("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?C(this):E(this),null;if(0===(t=x(t,e))&&e.ended)return 0===e.length&&C(this),null;var r,i=e.needReadable;return d("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&d("length less than watermark",i=!0),e.ended||e.reading?d("reading or ended",i=!1):i&&(d("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=x(n,e))),null===(r=t>0?N(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&C(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,d("pipe count=%d opts=%j",o.pipesCount,e);var u=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?f:_;function c(e,r){d("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",l),t.removeListener("error",w),t.removeListener("unpipe",c),n.removeListener("end",f),n.removeListener("end",_),n.removeListener("data",v),h=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}function f(){d("onend"),t.end()}o.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",c);var l=function(t){return function(){var e=t._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,P(t))}}(n);t.on("drain",l);var h=!1;var p=!1;function v(e){d("ondata"),p=!1,!1!==t.write(e)||p||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==B(o.pipes,t))&&!h&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function w(e){d("onerror",e),_(),t.removeListener("error",w),0===a(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",g),_()}function g(){d("onfinish"),t.removeListener("close",y),_()}function _(){d("unpipe"),n.unpipe(t)}return n.on("data",v),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",w),t.once("close",y),t.once("finish",g),t.emit("pipe",n),o.flowing||(d("pipe resume"),n.resume()),t},_.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=B(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},_.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&E(this):i.nextTick(A,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(M,t,e))}(this,t)),this},_.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(d("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){(d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause())))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<y.length;o++)t.on(y[o],this.emit.bind(this,y[o]));return this._read=function(e){d("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=N}).call(this,n(26),n(149))},function(t,e,n){t.exports=n(171).EventEmitter},function(t,e,n){"use strict";var r=n(150);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=o;var r=n(100),i=n(141);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(this,null,null)}function a(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(23),i.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){var r=n(23),i=n(112),o=n(41).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function u(){this.init(),this._w=a,i.call(this,64,56)}function c(t,e,n){return n^t&(e^n)}function f(t,e,n){return t&e|n&(t|e)}function l(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function h(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function d(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function p(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}r(u,i),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,u=0|this._f,v=0|this._g,w=0|this._h,y=0;y<16;++y)e[y]=t.readInt32BE(4*y);for(;y<64;++y)e[y]=p(e[y-2])+e[y-7]+d(e[y-15])+e[y-16]|0;for(var g=0;g<64;++g){var _=w+h(a)+c(a,u,v)+s[g]+e[g]|0,b=l(n)+f(n,r,i)|0;w=v,v=u,u=a,a=o+_|0,o=i,i=r,r=n,n=_+b|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0,this._f=u+this._f|0,this._g=v+this._g|0,this._h=w+this._h|0},u.prototype._hash=function(){var t=o.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=u},function(t,e,n){var r=n(23),i=n(112),o=n(41).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function u(){this.init(),this._w=a,i.call(this,128,112)}function c(t,e,n){return n^t&(e^n)}function f(t,e,n){return t&e|n&(t|e)}function l(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function h(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function d(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function v(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function w(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function y(t,e){return t>>>0<e>>>0?1:0}r(u,i),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(t){for(var e=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,a=0|this._eh,u=0|this._fh,g=0|this._gh,_=0|this._hh,b=0|this._al,m=0|this._bl,S=0|this._cl,x=0|this._dl,E=0|this._el,k=0|this._fl,T=0|this._gl,O=0|this._hl,A=0;A<32;A+=2)e[A]=t.readInt32BE(4*A),e[A+1]=t.readInt32BE(4*A+4);for(;A<160;A+=2){var M=e[A-30],P=e[A-30+1],N=d(M,P),C=p(P,M),I=v(M=e[A-4],P=e[A-4+1]),B=w(P,M),R=e[A-14],L=e[A-14+1],j=e[A-32],F=e[A-32+1],U=C+L|0,H=N+R+y(U,C)|0;H=(H=H+I+y(U=U+B|0,B)|0)+j+y(U=U+F|0,F)|0,e[A]=H,e[A+1]=U}for(var D=0;D<160;D+=2){H=e[D],U=e[D+1];var W=f(n,r,i),q=f(b,m,S),V=l(n,b),K=l(b,n),Y=h(a,E),G=h(E,a),z=s[D],J=s[D+1],$=c(a,u,g),X=c(E,k,T),Z=O+G|0,Q=_+Y+y(Z,O)|0;Q=(Q=(Q=Q+$+y(Z=Z+X|0,X)|0)+z+y(Z=Z+J|0,J)|0)+H+y(Z=Z+U|0,U)|0;var tt=K+q|0,et=V+W+y(tt,K)|0;_=g,O=T,g=u,T=k,u=a,k=E,a=o+Q+y(E=x+Z|0,x)|0,o=i,x=S,i=r,S=m,r=n,m=b,n=Q+et+y(b=Z+tt|0,Z)|0}this._al=this._al+b|0,this._bl=this._bl+m|0,this._cl=this._cl+S|0,this._dl=this._dl+x|0,this._el=this._el+E|0,this._fl=this._fl+k|0,this._gl=this._gl+T|0,this._hl=this._hl+O|0,this._ah=this._ah+n+y(this._al,b)|0,this._bh=this._bh+r+y(this._bl,m)|0,this._ch=this._ch+i+y(this._cl,S)|0,this._dh=this._dh+o+y(this._dl,x)|0,this._eh=this._eh+a+y(this._el,E)|0,this._fh=this._fh+u+y(this._fl,k)|0,this._gh=this._gh+g+y(this._gl,T)|0,this._hh=this._hh+_+y(this._hl,O)|0},u.prototype._hash=function(){var t=o.allocUnsafe(64);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(13)),i=h(n(61)),o=h(n(136)),s=h(n(1)),a=h(n(3)),u=h(n(109)),c=n(16),f=h(c),l=h(n(152));function h(t){return t&&t.__esModule?t:{default:t}}var d=function(){function t(e){(0,s.default)(this,t),this.id=null,this.isMy=null,this.owner=null,this.participant=null,this.buyCurrency=null,this.sellCurrency=null,this.buyAmount=null,this.sellAmount=null;var n=f.default.env.storage.getItem("swap."+e);if(!n){var r=f.default.services.orders.getByKey(e);n=this._getDataFromOrder(r)}this.update(n),this.events=new c.Events,this.room=new l.default({swapId:e,participantPeer:this.participant.peer});var i=f.default.flows[n.sellCurrency.toUpperCase()+"2"+n.buyCurrency.toUpperCase()];if(!i)throw new Error('Flow with name "'+n.sellCurrency.toUpperCase()+"2"+n.buyCurrency.toUpperCase()+'" not found in SwapApp.flows');this.flow=new i(this)}return(0,a.default)(t,[{key:"_getDataFromOrder",value:function(t){var e=c.util.pullProps(t,"id","isMy","owner","participant","buyCurrency","sellCurrency","buyAmount","sellAmount"),n=e.isMy,r=e.buyCurrency,s=e.sellCurrency,a=e.buyAmount,u=e.sellAmount,f=(0,o.default)(e,["isMy","buyCurrency","sellCurrency","buyAmount","sellAmount"]),l=(0,i.default)({},f,{isMy:n,buyCurrency:n?r:s,sellCurrency:n?s:r,buyAmount:n?a:u,sellAmount:n?u:a});return l.participant||n||(l.participant=l.owner),l}},{key:"_pullRequiredData",value:function(t){return c.util.pullProps(t,"id","isMy","owner","participant","buyCurrency","sellCurrency","buyAmount","sellAmount")}},{key:"_saveState",value:function(){var t=this._pullRequiredData(this);f.default.env.storage.setItem("swap."+this.id,t)}},{key:"update",value:function(t){var e=this;(0,r.default)(t).forEach(function(n){e[n]="buyAmount"===n||"sellAmount"===n?new u.default(String(t[n])):t[n]}),this._saveState()}},{key:"on",value:function(t,e){this.events.subscribe(t,e)}},{key:"off",value:function(t,e){this.events.unsubscribe(t,e)}}]),t}();e.default=d,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=l(n(62)),i=l(n(63)),o=l(n(151)),s=l(n(61)),a=l(n(1)),u=l(n(3)),c=l(n(16)),f=l(n(152));function l(t){return t&&t.__esModule?t:{default:t}}var h=function(){function t(e){(0,a.default)(this,t),this.swap=e,this.steps=[],this.stepNumbers={},this.state={step:0,isWaitingForOwner:!1}}return(0,u.default)(t,[{key:"_persistState",value:function(){var t=this,e=c.default.env.storage.getItem("flow."+this.swap.id);e&&(this.state=(0,s.default)({},this.state,e)),this.swap.room.on("persist state",function(e){t.setState(e,!0)})}},{key:"_persistSteps",value:function(){var t=this;this.steps=[].concat((0,o.default)(this._getInitialSteps()),(0,o.default)(this._getSteps())),setTimeout(function(){t.state.step>=t.steps.length||t.goStep(t.state.step)},0)}},{key:"_getInitialSteps",value:function(){var t=this,e=this;return[(0,i.default)(r.default.mark(function n(){var i,o;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=t.swap,o=i.id,i.owner?e.finishStep():(e.setState({isWaitingForOwner:!0}),c.default.services.room.on("new orders",function(t){var n=t.orders;if(n.find(function(t){return t.id===o})){this.unsubscribe();var r=n.getByKey(o);e.swap.room=new f.default({participantPeer:r.owner.peer}),e.swap.update((0,s.default)({},r,{participant:r.owner})),e.finishStep({isWaitingForOwner:!1})}}));case 2:case"end":return n.stop()}},n,t)}))]}},{key:"_getSteps",value:function(){return[]}},{key:"_saveState",value:function(){c.default.env.storage.setItem("flow."+this.swap.id,this.state)}},{key:"finishStep",value:function(t,e){if(console.log("on step "+this.state.step+", constraints =",e),e){var n=e.step,r=e.silentError,i=this.stepNumbers[n];if(console.log("trying to finish step "+n+" = "+i+" when on step "+this.state.step),n&&this.state.step<i){if(r)return void console.error("Cant finish step "+n+" = "+i+" when on step "+this.state.step);throw new Error("Cant finish step "+n+" = "+i+" when on step "+this.state.step)}}console.log("proceed to step "+(this.state.step+1)+", data=",t),this.goNextStep(t)}},{key:"goNextStep",value:function(t){var e=this.state.step,n=e+1;this.swap.events.dispatch("leave step",e),this.setState((0,s.default)({step:n},t||{}),!0),this.goStep(n)}},{key:"goStep",value:function(t){this.swap.events.dispatch("enter step",t),this.steps[t]()}},{key:"setState",value:function(t,e){this.state=(0,s.default)({},this.state,t),e&&this._saveState(),this.swap.events.dispatch("state update",this.state,t)}}]),t}();e.default=h,t.exports=e.default},function(t,e,n){var r={"./":142,"./SwapAuth":153,"./SwapAuth.js":153,"./btc":177,"./btc.js":177,"./eth":178,"./eth.js":178,"./index":142,"./index.js":142};function i(t){var e=o(t);return n(e)}function o(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=193},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(195));e.default=r.default,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=g(n(136)),i=g(n(32)),o=g(n(1)),s=g(n(37)),a=g(n(3)),u=g(n(38)),c=g(n(13)),f=g(n(61)),l=g(n(109)),h=n(16),d=g(h),p=g(n(175)),v=g(n(196)),w=g(n(182)),y=g(n(202));function g(t){return t&&t.__esModule?t:{default:t}}var _=function(){var t=Date.now();return function(){return d.default.services.room.peer+"-"+ ++t}}(),b=function(t,e){var n=function(t){var e={id:"?String",owner:(0,f.default)({peer:"String",reputation:h.util.typeforce.t.maybe(h.util.typeforce.isNumeric)},function(){var t={};return(0,c.default)(h.constants.COINS).forEach(function(e){t[e]=h.util.typeforce.t.maybe({address:h.util.typeforce.isCoinAddress[h.constants.COINS[e]],publicKey:h.util.typeforce.isPublicKey[h.constants.COINS[e]]})}),t}()),buyCurrency:h.util.typeforce.isCoinName,sellCurrency:h.util.typeforce.isCoinName,buyAmount:h.util.typeforce.isNumeric,sellAmount:h.util.typeforce.isNumeric,exchangeRate:h.util.typeforce.t.maybe(h.util.typeforce.isNumeric),isProcessing:"?Boolean",isRequested:"?Boolean"},n=h.util.typeforce.check(e,t,!0);return n||console.log("Wrong income order format. Excepted:",e,"got:",t),n}(t),r=function(t,e){return t.owner.peer===e}(t,e);return n&&r},m=function(t){function e(){(0,o.default)(this,e);var t=(0,s.default)(this,(e.__proto__||(0,i.default)(e)).call(this));return t._handleReady=function(){t._persistMyOrders()},t._handleUserOnline=function(e){var n=t.getMyOrders();n.length&&(n=n.map(function(t){return h.util.pullProps(t,"id","owner","buyCurrency","sellCurrency","buyAmount","exchangeRate","sellAmount","isRequested","isProcessing")}),d.default.services.room.sendMessage(e,[{event:"new orders",data:{orders:n}}]))},t._handleUserOffline=function(e){var n=t.getPeerOrders(e);n.length&&n.forEach(function(e){var n=e.id;t._handleRemove(n)})},t._handleNewOrders=function(e){var n=e.fromPeer,r=e.orders.filter(function(e){var r=e.id,i=e.owner.peer;return!t.getByKey(r)&&i===n});t._handleMultipleCreate({orders:r,fromPeer:n})},t._handleNewOrder=function(e){var n=e.fromPeer,r=e.order;r&&r.owner&&r.owner.peer===n&&b(r,n)&&t._handleCreate(r)},t._handleRemoveOrder=function(e){var n=e.fromPeer,r=e.orderId,i=t.getByKey(r);i&&i.owner&&i.owner.peer===n&&t._handleRemove(r)},t._serviceName="orders",t._dependsOn=[p.default],t}return(0,u.default)(e,t),(0,a.default)(e,null,[{key:"name",get:function(){return"orders"}}]),(0,a.default)(e,[{key:"initService",value:function(){d.default.services.room.on("ready",this._handleReady),d.default.services.room.on("user online",this._handleUserOnline),d.default.services.room.on("user offline",this._handleUserOffline),d.default.services.room.on("new orders",this._handleNewOrders),d.default.services.room.on("new order",this._handleNewOrder),d.default.services.room.on("remove order",this._handleRemoveOrder)}},{key:"_persistMyOrders",value:function(){var t=this;this.getMyOrders().forEach(function(e){t._handleCreate(e)})}},{key:"_create",value:function(t){var e=t.id,n=t.buyAmount,i=t.sellAmount,o=t.buyCurrency,s=t.sellCurrency,a=(0,r.default)(t,["id","buyAmount","sellAmount","buyCurrency","sellCurrency"]),u=new y.default(this,(0,f.default)({id:e||_(),buyAmount:new l.default(String(n)),sellAmount:new l.default(String(i)),buyCurrency:o.toUpperCase(),sellCurrency:s.toUpperCase()},a));return this.append(u,u.id),u}},{key:"_handleCreate",value:function(t){var e=this._create(t);e&&w.default.dispatch("new order",e)}},{key:"_handleMultipleCreate",value:function(t){var e=this,n=t.orders,r=t.fromPeer,i=[];n.forEach(function(t){if(b(t,r)){var n=e._create(t);i.push(n)}}),i.length&&w.default.dispatch("new orders",i)}},{key:"_handleRemove",value:function(t){try{var e=this.getByKey(t);e&&(this.removeByKey(t),w.default.dispatch("remove order",e))}catch(t){}}},{key:"_saveMyOrders",value:function(){var t=this.items.filter(function(t){return t.owner.peer===d.default.services.room.peer});t=t.map(function(t){return h.util.pullProps(t,"id","owner","buyCurrency","sellCurrency","buyAmount","sellAmount","exchangeRate","participant","requests","isRequested","isProcessing")}),d.default.env.storage.setItem("myOrders",t)}},{key:"getMyOrders",value:function(){return d.default.env.storage.getItem("myOrders")||[]}},{key:"getPeerOrders",value:function(t){return this.items.filter(function(e){var n=e.owner;return t===n.peer})}},{key:"create",value:function(t){var e=this._create((0,f.default)({},t,{owner:d.default.services.auth.getPublicData()}));this._saveMyOrders(),d.default.services.room.sendMessage([{event:"new order",data:{order:h.util.pullProps(e,"id","owner","buyCurrency","exchangeRate","sellCurrency","buyAmount","sellAmount","isRequested","isProcessing")}}])}},{key:"remove",value:function(t){this.removeByKey(t),d.default.services.room.sendMessage([{event:"remove order",data:{orderId:t}}]),this._saveMyOrders()}},{key:"on",value:function(t,e){return w.default.subscribe(t,e),this}},{key:"off",value:function(t,e){return w.default.unsubscribe(t,e),this}}]),e}((0,v.default)(h.ServiceInterface,h.Collection));e.default=m,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=l(n(176)),i=l(n(45)),o=l(n(197)),s=l(n(199)),a=l(n(32)),u=l(n(1)),c=l(n(37)),f=l(n(38));function l(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),l=1;l<e;l++)n[l-1]=arguments[l];var h=function(t){function e(){var t;(0,u.default)(this,e);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=(0,c.default)(this,(t=e.__proto__||(0,a.default)(e)).call.apply(t,[this].concat(i)));return n.forEach(function(t){t.prototype._constructor.call(s)}),s}return(0,f.default)(e,t),e}(t),d=function(t,e){(0,s.default)(e).concat((0,o.default)(e)).forEach(function(n){n.match(/^(?:_?constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||(0,i.default)(t,n,(0,r.default)(e,n))})};return n.forEach(function(t){d(h.prototype,t.prototype),d(h,t)}),h},t.exports=e.default},function(t,e,n){t.exports={default:n(198),__esModule:!0}},function(t,e,n){n(107),t.exports=n(0).Object.getOwnPropertySymbols},function(t,e,n){t.exports={default:n(200),__esModule:!0}},function(t,e,n){n(201);var r=n(0).Object;t.exports=function(t){return r.getOwnPropertyNames(t)}},function(t,e,n){n(42)("getOwnPropertyNames",function(){return n(108).f})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(151)),i=f(n(13)),o=f(n(61)),s=f(n(1)),a=f(n(3)),u=f(n(16)),c=f(n(182));function f(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(e,n){(0,s.default)(this,t),this.id=n.id,this.isMy=null,this.owner=null,this.participant=null,this.buyCurrency=null,this.exchangeRate=null,this.sellCurrency=null,this.buyAmount=null,this.sellAmount=null,this.collection=e,this.requests=[],this.isRequested=!1,this.isProcessing=!1,this._update((0,o.default)({},n,{isMy:n.owner.peer===u.default.services.room.peer})),this._onMount()}return(0,a.default)(t,[{key:"_onMount",value:function(){var t=this;u.default.services.room.on("request swap",function(e){var n=e.orderId,r=e.participant;n!==t.id||t.requests.find(function(t){return t.peer===r.peer})||(t.requests.push(r),c.default.dispatch("new order request",{orderId:n,participant:r}))})}},{key:"_update",value:function(t){var e=this;(0,i.default)(t).forEach(function(n){e[n]=t[n]})}},{key:"update",value:function(t){this._update(t),this.collection._saveMyOrders(),c.default.dispatch("swap update",this,t)}},{key:"sendRequest",value:function(t){var e=this;u.default.services.room.peer!==this.owner.peer?this.isRequested?console.warn("You have already requested this swap."):(this.update({isRequested:!0}),u.default.services.room.sendMessage(this.owner.peer,[{event:"request swap",data:{orderId:this.id,participant:u.default.services.auth.getPublicData()}}]),u.default.services.room.on("accept swap request",function(n){n.orderId===e.id&&(this.unsubscribe(),e.update({isProcessing:!0,isRequested:!1}),t(!0))}),u.default.services.room.on("decline swap request",function(n){n.orderId===e.id&&(this.unsubscribe(),e.update({isRequested:!1}),t(!1))})):console.warn("You are the owner of this Order. You can't send request to yourself.")}},{key:"acceptRequest",value:function(t){var e=this.requests.find(function(e){return e.peer===t});this.update({isRequested:!1,isProcessing:!0,participant:e,requests:[]}),u.default.services.room.sendMessage(t,[{event:"accept swap request",data:{orderId:this.id}}])}},{key:"declineRequest",value:function(t){var e=void 0;this.requests.some(function(n,r){return n.peer===t&&(e=r),void 0!==e});var n=[].concat((0,r.default)(this.requests.slice(0,e)),(0,r.default)(this.requests.slice(e+1)));this.update({isRequested:!1,requests:n}),u.default.services.room.sendMessage(t,[{event:"decline swap request",data:{orderId:this.id}}])}}]),t}();e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BTC2ETHTOKEN=e.ETHTOKEN2BTC=e.BTC2ETH=e.ETH2BTC=void 0;var r=a(n(204)),i=a(n(225)),o=a(n(226)),s=a(n(227));function a(t){return t&&t.__esModule?t:{default:t}}e.ETH2BTC=r.default,e.BTC2ETH=i.default,e.ETHTOKEN2BTC=o.default,e.BTC2ETHTOKEN=s.default},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=v(n(62)),o=v(n(63)),s=v(n(32)),a=v(n(1)),u=v(n(37)),c=v(n(3)),f=v(n(38)),l=v(n(147)),h=v(n(148)),d=n(16),p=v(d);function v(t){return t&&t.__esModule?t:{default:t}}var w=function(t){function e(t){(0,a.default)(this,e);var n=(0,u.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t));if(n._flowName=e.getName(),n.ethSwap=p.default.swaps[d.constants.COINS.eth],n.btcSwap=p.default.swaps[d.constants.COINS.btc],n.myBtcAddress=p.default.services.auth.accounts.btc.getAddress(),n.myEthAddress=p.default.services.auth.accounts.eth.address,n.stepNumbers={sign:1,"wait-lock-btc":2,"verify-script":3,"sync-balance":4,"lock-eth":5,"wait-withdraw-eth":6,"withdraw-btc":7,finish:8,end:9},!n.ethSwap)throw new Error('BTC2ETH: "ethSwap" of type object required');if(!n.btcSwap)throw new Error('BTC2ETH: "btcSwap" of type object required');return n.state={step:0,signTransactionHash:null,isSignFetching:!1,isMeSigned:!1,secretHash:null,btcScriptValues:null,btcScriptVerified:!1,isBalanceFetching:!1,isBalanceEnough:!1,balance:null,btcScriptCreatingTransactionHash:null,ethSwapCreationTransactionHash:null,isEthContractFunded:!1,secret:null,isEthWithdrawn:!1,isBtcWithdrawn:!1,refundTransactionHash:null,isRefunded:!1,isFinished:!1},(0,l.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"_persistSteps",n).call(n),n._persistState(),n}return(0,f.default)(e,t),(0,c.default)(e,null,[{key:"getName",value:function(){return d.constants.COINS.eth+"2"+d.constants.COINS.btc}}]),(0,c.default)(e,[{key:"_persistState",value:function(){(0,l.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"_persistState",this).call(this)}},{key:"_getSteps",value:function(){var t=this,e=this;return[function(){},function(){e.swap.room.once("create btc script",function(t){var n=t.scriptValues,r=t.btcScriptCreatingTransactionHash;e.finishStep({secretHash:n.secretHash,btcScriptValues:n,btcScriptCreatingTransactionHash:r},{step:"wait-lock-btc",silentError:!0})}),e.swap.room.sendMessage("request btc script"),console.log("request btc script")},function(){console.log("waiting verify btc script")},function(){t.syncBalance()},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u,c,f,l,h;return i.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.swap,o=r.participant,s=r.buyAmount,a=r.sellAmount,u=void 0,c=function(){return Math.floor(Date.now()/1e3)},f=function(){return c()+3600},n.next=6,e.btcSwap.checkScript(e.state.btcScriptValues,{value:s,recipientPublicKey:p.default.services.auth.accounts.btc.getPublicKey(),lockTime:f()});case 6:if(!(l=n.sent)){n.next=11;break}return console.error("Btc script check error:",l),e.swap.events.dispatch("btc script check error",l),n.abrupt("return");case 11:return h={participantAddress:o.eth.address,secretHash:e.state.secretHash,amount:a},n.prev=12,n.next=15,t.ethSwap.create(h,function(t){u=t,e.setState({ethSwapCreationTransactionHash:t})});case 15:n.next=28;break;case 17:if(n.prev=17,n.t0=n.catch(12),!/known transaction/.test(n.t0.message)){n.next=23;break}return n.abrupt("return",console.error("known tx: "+n.t0.message));case 23:if(!/out of gas/.test(n.t0.message)){n.next=27;break}return n.abrupt("return",console.error("tx failed (wrong secret?): "+n.t0.message));case 27:return n.abrupt("return",console.error(n.t0));case 28:console.log("create ETH contract, hash="+u),e.swap.room.sendMessage("create eth contract",{ethSwapCreationTransactionHash:u}),console.log("finish step"),e.finishStep({isEthContractFunded:!0});case 32:case"end":return n.stop()}},n,t,[[12,17]])})),function(){var n=e.swap.participant,r=void 0;!function s(){r=setTimeout((0,o.default)(i.default.mark(function r(){var o;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=void 0,t.prev=1,t.next=4,e.ethSwap.getSecret({participantAddress:n.eth.address});case 4:o=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:o?e.state.isEthWithdrawn||e.finishStep({isEthWithdrawn:!0,secret:o},{step:"wait-withdraw-eth"}):s();case 10:case"end":return t.stop()}},r,t,[[1,7]])})),2e4)}(),e.swap.room.once("finish eth withdraw",function(){e.state.isEthWithdrawn||(clearTimeout(r),r=null,e.finishStep({isEthWithdrawn:!0},{step:"wait-withdraw-eth"}))})},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.swap.participant,o=e.state,s=o.secret,a=o.btcScriptValues,console.log("secret withdraw 7",s),console.log("btcScriptValues withdraw 7",a),a){t.next=7;break}return console.error('There is no "btcScriptValues" in state. No way to continue swap...'),t.abrupt("return");case 7:if(s){t.next=19;break}return t.prev=8,t.next=11,e.ethSwap.getSecret({participantAddress:r.eth.address});case 11:s=t.sent,e.setState({secret:s}),t.next=19;break;case 15:if(t.prev=15,t.t0=t.catch(8),/known transaction/.test(t.t0.message)){t.next=19;break}return t.abrupt("return",console.error(t.t0));case 19:if(s){t.next=30;break}return t.next=22,e.btcSwap.getBalance(a);case 22:if(u=t.sent,console.log("balance",u),0!==u){t.next=28;break}return console.log("Look like you already did withdraw"),e.finishStep({isBtcWithdrawn:!0}),t.abrupt("return");case 28:return console.error("FAIL! secret: "+s+", balance: "+u),t.abrupt("return");case 30:return t.next=32,e.btcSwap.withdraw({scriptValues:e.state.btcScriptValues,secret:s},function(t){e.setState({btcSwapWithdrawTransactionHash:t})});case 32:e.finishStep({isBtcWithdrawn:!0});case 33:case"end":return t.stop()}},n,t,[[8,15]])})),function(){e.swap.room.sendMessage("swap finished"),e.finishStep({isFinished:!0})},function(){}]}},{key:"_checkSwapAlreadyExists",value:function(){var t=this.swap.participant,e={ownerAddress:p.default.services.auth.accounts.eth.address,participantAddress:t.eth.address};return this.ethSwap.checkSwapExists(e)}},{key:"sign",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.swap.participant,!this.state.isMeSigned){t.next=4;break}return t.abrupt("return",this.swap.room.sendMessage("swap sign"));case 4:return t.next=6,this._checkSwapAlreadyExists();case 6:if(!t.sent){t.next=11;break}throw this.swap.room.sendMessage("swap exists"),new Error("Cannot sign: swap with "+e.eth.address+" already exists! Please refund it or drop "+this.swap.id);case 11:return this.setState({isSignFetching:!0}),this.swap.room.once("request sign",function(){n.swap.room.sendMessage("swap sign")}),this.swap.room.sendMessage("swap sign"),this.finishStep({isMeSigned:!0},{step:"sign"}),t.abrupt("return",!0);case 16:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"verifyBtcScript",value:function(){if(this.state.btcScriptVerified)return!0;if(!this.state.btcScriptValues)throw new Error("No script, cannot verify");return this.finishStep({btcScriptVerified:!0},{step:"verify-script"}),!0}},{key:"syncBalance",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.swap.sellAmount,this.setState({isBalanceFetching:!0}),t.next=4,this.ethSwap.fetchBalance(p.default.services.auth.accounts.eth.address);case 4:n=t.sent,e.isLessThanOrEqualTo(n)?this.finishStep({balance:n,isBalanceFetching:!1,isBalanceEnough:!0},{step:"sync-balance"}):this.setState({balance:n,isBalanceFetching:!1,isBalanceEnough:!1});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"tryWithdraw",value:function(){var t=(0,o.default)(i.default.mark(function t(e){var n,o,s,a,u,c,f,l,d,p=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.state,o=n.secret,s=n.secretHash,n.isEthWithdrawn,a=n.isBtcWithdrawn,u=n.btcScriptValues,e){t.next=3;break}throw new Error("Withdrawal is automatic. For manual withdrawal, provide a secret");case 3:if(u){t.next=5;break}throw new Error("Cannot withdraw without script values");case 5:return o&&o!=e&&console.warn("Secret already known and is different. Are you sure?"),a&&console.warn("Looks like money were already withdrawn, are you sure?"),console.log("WITHDRAW using secret = "+e),c=h.default.ripemd160(r.from(e,"hex")).toString("hex"),s!=c&&console.warn("Hash does not match!"),f=this.btcSwap.createScript(u),l=f.scriptAddress,t.next=13,this.btcSwap.getBalance(l);case 13:if(d=t.sent,console.log("address="+l+", balance="+d),0!==d){t.next=18;break}throw flow.finishStep({isBtcWithdrawn:!0},{step:"withdraw-btc"}),new Error("Already withdrawn: address="+l+",balance="+d);case 18:return t.next=20,this.btcSwap.withdraw({scriptValues:u,secret:e},function(t){console.log("TX hash="+t),p.setState({btcSwapWithdrawTransactionHash:t})});case 20:console.log("TX withdraw sent: "+this.state.btcSwapWithdrawTransactionHash),this.finishStep({isBtcWithdrawn:!0},{step:"withdraw-btc"});case 22:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"tryRefund",value:function(){var t=this,e=this.swap.participant;this.ethSwap.refund({participantAddress:e.eth.address},function(e){t.setState({refundTransactionHash:e})}).then(function(){t.setState({isRefunded:!0})})}}]),e}(n(117).Flow);e.default=w,t.exports=e.default}).call(this,n(27).Buffer)},function(t,e,n){"use strict";var r=n(23),i=n(206),o=n(218),s=n(219),a=n(224);function u(t){a.call(this,"digest"),this._hash=t}r(u,a),u.prototype._update=function(t){this._hash.update(t)},u.prototype._final=function(){return this._hash.digest()},t.exports=function(t){return"md5"===(t=t.toLowerCase())?new i:"rmd160"===t||"ripemd160"===t?new o:new u(s(t))}},function(t,e,n){"use strict";(function(e){var r=n(23),i=n(183),o=new Array(16);function s(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function a(t,e){return t<<e|t>>>32-e}function u(t,e,n,r,i,o,s){return a(t+(e&n|~e&r)+i+o|0,s)+e|0}function c(t,e,n,r,i,o,s){return a(t+(e&r|n&~r)+i+o|0,s)+e|0}function f(t,e,n,r,i,o,s){return a(t+(e^n^r)+i+o|0,s)+e|0}function l(t,e,n,r,i,o,s){return a(t+(n^(e|~r))+i+o|0,s)+e|0}r(s,i),s.prototype._update=function(){for(var t=o,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var n=this._a,r=this._b,i=this._c,s=this._d;r=l(r=l(r=l(r=l(r=f(r=f(r=f(r=f(r=c(r=c(r=c(r=c(r=u(r=u(r=u(r=u(r,i=u(i,s=u(s,n=u(n,r,i,s,t[0],3614090360,7),r,i,t[1],3905402710,12),n,r,t[2],606105819,17),s,n,t[3],3250441966,22),i=u(i,s=u(s,n=u(n,r,i,s,t[4],4118548399,7),r,i,t[5],1200080426,12),n,r,t[6],2821735955,17),s,n,t[7],4249261313,22),i=u(i,s=u(s,n=u(n,r,i,s,t[8],1770035416,7),r,i,t[9],2336552879,12),n,r,t[10],4294925233,17),s,n,t[11],2304563134,22),i=u(i,s=u(s,n=u(n,r,i,s,t[12],1804603682,7),r,i,t[13],4254626195,12),n,r,t[14],2792965006,17),s,n,t[15],1236535329,22),i=c(i,s=c(s,n=c(n,r,i,s,t[1],4129170786,5),r,i,t[6],3225465664,9),n,r,t[11],643717713,14),s,n,t[0],3921069994,20),i=c(i,s=c(s,n=c(n,r,i,s,t[5],3593408605,5),r,i,t[10],38016083,9),n,r,t[15],3634488961,14),s,n,t[4],3889429448,20),i=c(i,s=c(s,n=c(n,r,i,s,t[9],568446438,5),r,i,t[14],3275163606,9),n,r,t[3],4107603335,14),s,n,t[8],1163531501,20),i=c(i,s=c(s,n=c(n,r,i,s,t[13],2850285829,5),r,i,t[2],4243563512,9),n,r,t[7],1735328473,14),s,n,t[12],2368359562,20),i=f(i,s=f(s,n=f(n,r,i,s,t[5],4294588738,4),r,i,t[8],2272392833,11),n,r,t[11],1839030562,16),s,n,t[14],4259657740,23),i=f(i,s=f(s,n=f(n,r,i,s,t[1],2763975236,4),r,i,t[4],1272893353,11),n,r,t[7],4139469664,16),s,n,t[10],3200236656,23),i=f(i,s=f(s,n=f(n,r,i,s,t[13],681279174,4),r,i,t[0],3936430074,11),n,r,t[3],3572445317,16),s,n,t[6],76029189,23),i=f(i,s=f(s,n=f(n,r,i,s,t[9],3654602809,4),r,i,t[12],3873151461,11),n,r,t[15],530742520,16),s,n,t[2],3299628645,23),i=l(i,s=l(s,n=l(n,r,i,s,t[0],4096336452,6),r,i,t[7],1126891415,10),n,r,t[14],2878612391,15),s,n,t[5],4237533241,21),i=l(i,s=l(s,n=l(n,r,i,s,t[12],1700485571,6),r,i,t[3],2399980690,10),n,r,t[10],4293915773,15),s,n,t[1],2240044497,21),i=l(i,s=l(s,n=l(n,r,i,s,t[8],1873313359,6),r,i,t[15],4264355552,10),n,r,t[6],2734768916,15),s,n,t[13],1309151649,21),i=l(i,s=l(s,n=l(n,r,i,s,t[4],4149444226,6),r,i,t[11],3174756917,10),n,r,t[2],718787259,15),s,n,t[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+s|0},s.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=new e(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=s}).call(this,n(27).Buffer)},function(t,e){},function(t,e,n){"use strict";var r=n(41).Buffer,i=n(209);function o(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),n=this.head,i=0;n;)o(n.data,e,i),i+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(211),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(26))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i=1,o={},s=!1,a=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){f(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&f(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){f(t.data)},r=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var t=a.documentElement;r=function(e){var n=a.createElement("script");n.onreadystatechange=function(){f(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():r=function(t){setTimeout(f,0,t)},u.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return o[i]=s,r(i),i++},u.clearImmediate=c}function c(t){delete o[t]}function f(t){if(s)setTimeout(f,0,t);else{var e=o[t];if(e){s=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{c(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(26),n(149))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(26))},function(t,e,n){"use strict";t.exports=o;var r=n(188),i=n(141);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(23),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(173)},function(t,e,n){t.exports=n(100)},function(t,e,n){t.exports=n(172).Transform},function(t,e,n){t.exports=n(172).PassThrough},function(t,e,n){"use strict";var r=n(27).Buffer,i=n(23),o=n(183),s=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],l=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0];function d(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(t,e){return t<<e|t>>>32-e}function v(t,e,n,r,i,o,s,a){return p(t+(e^n^r)+o+s|0,a)+i|0}function w(t,e,n,r,i,o,s,a){return p(t+(e&n|~e&r)+o+s|0,a)+i|0}function y(t,e,n,r,i,o,s,a){return p(t+((e|~n)^r)+o+s|0,a)+i|0}function g(t,e,n,r,i,o,s,a){return p(t+(e&r|n&~r)+o+s|0,a)+i|0}function _(t,e,n,r,i,o,s,a){return p(t+(e^(n|~r))+o+s|0,a)+i|0}i(d,o),d.prototype._update=function(){for(var t=s,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,d=0|this._e,b=0|this._a,m=0|this._b,S=0|this._c,x=0|this._d,E=0|this._e,k=0;k<80;k+=1){var T,O;k<16?(T=v(n,r,i,o,d,t[a[k]],l[0],c[k]),O=_(b,m,S,x,E,t[u[k]],h[0],f[k])):k<32?(T=w(n,r,i,o,d,t[a[k]],l[1],c[k]),O=g(b,m,S,x,E,t[u[k]],h[1],f[k])):k<48?(T=y(n,r,i,o,d,t[a[k]],l[2],c[k]),O=y(b,m,S,x,E,t[u[k]],h[2],f[k])):k<64?(T=g(n,r,i,o,d,t[a[k]],l[3],c[k]),O=w(b,m,S,x,E,t[u[k]],h[3],f[k])):(T=_(n,r,i,o,d,t[a[k]],l[4],c[k]),O=v(b,m,S,x,E,t[u[k]],h[4],f[k])),n=d,d=o,o=p(i,10),i=r,r=T,b=E,E=x,x=p(S,10),S=m,m=O}var A=this._b+i+x|0;this._b=this._c+o+E|0,this._c=this._d+d+b|0,this._d=this._e+n+m|0,this._e=this._a+r+S|0,this._a=A},d.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=r.alloc?r.alloc(20):new r(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=d},function(t,e,n){(e=t.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n}).sha=n(220),e.sha1=n(221),e.sha224=n(222),e.sha256=n(189),e.sha384=n(223),e.sha512=n(190)},function(t,e,n){var r=n(23),i=n(112),o=n(41).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function u(){this.init(),this._w=a,i.call(this,64,56)}function c(t){return t<<5|t>>>27}function f(t){return t<<30|t>>>2}function l(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(u,i),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,u=0;u<16;++u)e[u]=t.readInt32BE(4*u);for(;u<80;++u)e[u]=e[u-3]^e[u-8]^e[u-14]^e[u-16];for(var h=0;h<80;++h){var d=~~(h/20),p=c(n)+l(d,r,i,o)+a+e[h]+s[d]|0;a=o,o=i,i=f(r),r=n,n=p}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0},u.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=u},function(t,e,n){var r=n(23),i=n(112),o=n(41).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function u(){this.init(),this._w=a,i.call(this,64,56)}function c(t){return t<<1|t>>>31}function f(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function h(t,e,n,r){return 0===t?e&n|~e&r:2===t?e&n|e&r|n&r:e^n^r}r(u,i),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(t){for(var e=this._w,n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,a=0|this._e,u=0;u<16;++u)e[u]=t.readInt32BE(4*u);for(;u<80;++u)e[u]=c(e[u-3]^e[u-8]^e[u-14]^e[u-16]);for(var d=0;d<80;++d){var p=~~(d/20),v=f(n)+h(p,r,i,o)+a+e[d]+s[p]|0;a=o,o=i,i=l(r),r=n,n=v}this._a=n+this._a|0,this._b=r+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=a+this._e|0},u.prototype._hash=function(){var t=o.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=u},function(t,e,n){var r=n(23),i=n(189),o=n(112),s=n(41).Buffer,a=new Array(64);function u(){this.init(),this._w=a,o.call(this,64,56)}r(u,i),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var t=s.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=u},function(t,e,n){var r=n(23),i=n(190),o=n(112),s=n(41).Buffer,a=new Array(160);function u(){this.init(),this._w=a,o.call(this,128,112)}r(u,i),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var t=s.allocUnsafe(48);function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=u},function(t,e,n){var r=n(41).Buffer,i=n(184).Transform,o=n(174).StringDecoder;function s(t){i.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(23)(s,i),s.prototype.update=function(t,e,n){"string"==typeof t&&(t=r.from(t,e));var i=this._update(t);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(t,e,n){var r;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){r=t}finally{n(r)}},s.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},s.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},s.prototype._toString=function(t,e,n){if(this._decoder||(this._decoder=new o(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var r=this._decoder.write(t);return n&&(r+=this._decoder.end()),r},t.exports=s},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=v(n(62)),o=v(n(63)),s=v(n(32)),a=v(n(1)),u=v(n(37)),c=v(n(3)),f=v(n(38)),l=v(n(147)),h=v(n(148)),d=n(16),p=v(d);function v(t){return t&&t.__esModule?t:{default:t}}var w=function(t){function e(t){(0,a.default)(this,e);var n=(0,u.default)(this,(e.__proto__||(0,s.default)(e)).call(this,t));if(n.getRefundTxHex=function(){n.btcSwap.getRefundHexTransaction({scriptValues:n.state.btcScriptValues,secret:n.state.secret}).then(function(t){n.setState({refundTxHex:t})})},n._flowName=e.getName(),n.ethSwap=p.default.swaps[d.constants.COINS.eth],n.btcSwap=p.default.swaps[d.constants.COINS.btc],n.myBtcAddress=p.default.services.auth.accounts.btc.getAddress(),n.myEthAddress=p.default.services.auth.accounts.eth.address,n.stepNumbers={sign:1,"submit-secret":2,"sync-balance":3,"lock-btc":4,"wait-lock-eth":5,"withdraw-eth":6,finish:7,end:8},!n.ethSwap)throw new Error('BTC2ETH: "ethSwap" of type object required');if(!n.btcSwap)throw new Error('BTC2ETH: "btcSwap" of type object required');return n.state={step:0,signTransactionHash:null,isSignFetching:!1,isParticipantSigned:!1,btcScriptCreatingTransactionHash:null,ethSwapCreationTransactionHash:null,secretHash:null,btcScriptValues:null,btcScriptVerified:!1,isBalanceFetching:!1,isBalanceEnough:!1,balance:null,isEthContractFunded:!1,ethSwapWithdrawTransactionHash:null,isEthWithdrawn:!1,refundTransactionHash:null,isRefunded:!1,refundTxHex:null,isFinished:!1},(0,l.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"_persistSteps",n).call(n),n._persistState(),n}return(0,f.default)(e,t),(0,c.default)(e,null,[{key:"getName",value:function(){return d.constants.COINS.btc+"2"+d.constants.COINS.eth}}]),(0,c.default)(e,[{key:"_persistState",value:function(){(0,l.default)(e.prototype.__proto__||(0,s.default)(e.prototype),"_persistState",this).call(this)}},{key:"_getSteps",value:function(){var t=this,e=this;return[function(){e.swap.room.once("swap sign",function(){e.finishStep({isParticipantSigned:!0},{step:"sign",silentError:!0})}),e.swap.room.once("swap exists",function(){console.log("swap already exists")}),e.swap.room.sendMessage("request sign")},function(){},function(){t.syncBalance(),console.log("sync balance")},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u,c,f;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.swap,o=r.sellAmount,s=r.participant,a=void 0,u=function(){return Math.floor(Date.now()/1e3)},c=function(){return u()+10800},f={secretHash:e.state.secretHash,ownerPublicKey:p.default.services.auth.accounts.btc.getPublicKey(),recipientPublicKey:s.btc.publicKey,lockTime:c()},t.next=7,e.btcSwap.fundScript({scriptValues:f,amount:o},function(t){a=t,e.setState({btcScriptCreatingTransactionHash:t})});case 7:e.swap.room.on("request btc script",function(){e.swap.room.sendMessage("create btc script",{scriptValues:f,btcScriptCreatingTransactionHash:a})}),e.swap.room.sendMessage("create btc script",{scriptValues:f,btcScriptCreatingTransactionHash:a}),e.finishStep({isBtcScriptFunded:!0,btcScriptValues:f});case 10:case"end":return t.stop()}},n,t)})),function(){var n=e.swap.participant,r=void 0;e.swap.room.once("create eth contract",function(t){var n=t.ethSwapCreationTransactionHash;e.setState({ethSwapCreationTransactionHash:n})});!function s(){r=setTimeout((0,o.default)(i.default.mark(function r(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ethSwap.getBalance({ownerAddress:n.eth.address});case 2:t.sent>0?e.state.isEthContractFunded||e.finishStep({isEthContractFunded:!0},{step:"wait-lock-eth"}):s();case 4:case"end":return t.stop()}},r,t)})),2e4)}(),e.swap.room.once("create eth contract",function(){e.state.isEthContractFunded||(clearTimeout(r),r=null,e.finishStep({isEthContractFunded:!0},{step:"wait-lock-eth"}))})},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.swap,o=r.buyAmount,s=r.participant,a={ownerAddress:s.eth.address,secret:e.state.secret},t.next=4,e.ethSwap.checkBalance({ownerAddress:s.eth.address,expectedValue:o});case 4:if(!(u=t.sent)){t.next=9;break}return console.error("Waiting until deposit: ETH balance check error:",u),e.swap.events.dispatch("eth balance check error",u),t.abrupt("return");case 9:return t.prev=9,t.next=12,e.ethSwap.withdraw(a,function(t){e.setState({ethSwapWithdrawTransactionHash:t})});case 12:t.next=25;break;case 14:if(t.prev=14,t.t0=t.catch(9),!/known transaction/.test(t.t0.message)){t.next=20;break}return t.abrupt("return",console.error("known tx: "+t.t0.message));case 20:if(!/out of gas/.test(t.t0.message)){t.next=24;break}return t.abrupt("return",console.error("tx failed (wrong secret?): "+t.t0.message));case 24:return t.abrupt("return",console.error(t.t0));case 25:e.swap.room.sendMessage("finish eth withdraw"),e.finishStep({isEthWithdrawn:!0});case 27:case"end":return t.stop()}},n,t,[[9,14]])})),function(){e.swap.room.once("swap finished",function(){e.finishStep({isFinished:!0})})},function(){}]}},{key:"submitSecret",value:function(t){if(this.state.secret)return!0;if(!this.state.isParticipantSigned)throw new Error("Cannot proceed: participant not signed. step="+this.state.step);var e=h.default.ripemd160(r.from(t,"hex")).toString("hex");return this.finishStep({secret:t,secretHash:e},{step:"submit-secret"}),!0}},{key:"syncBalance",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.swap.sellAmount,this.setState({isBalanceFetching:!0}),t.next=4,this.btcSwap.fetchBalance(this.myBtcAddress);case 4:n=t.sent,e.isLessThanOrEqualTo(n)?this.finishStep({balance:n,isBalanceFetching:!1,isBalanceEnough:!0},{step:"sync-balance"}):(console.error("Not enough money: "+n+" < "+e),this.setState({balance:n,isBalanceFetching:!1,isBalanceEnough:!1}));case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"tryRefund",value:function(){var t=this;return this.btcSwap.refund({scriptValues:this.state.btcScriptValues,secret:this.state.secret},function(e){t.setState({refundTransactionHash:e})}).then(function(){t.setState({isRefunded:!0})})}}]),e}(n(117).Flow);e.default=w,t.exports=e.default}).call(this,n(27).Buffer)},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=w(n(62)),o=w(n(63)),s=w(n(32)),a=w(n(1)),u=w(n(37)),c=w(n(3)),f=w(n(38)),l=w(n(147)),h=w(n(148)),d=n(16),p=w(d),v=n(117);function w(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return function(e){function n(e){(0,a.default)(this,n);var r=(0,u.default)(this,(n.__proto__||(0,s.default)(n)).call(this,e));if(r._flowName=n.getName(),r.ethTokenSwap=p.default.swaps[t.toUpperCase()],r.btcSwap=p.default.swaps[d.constants.COINS.btc],r.myBtcAddress=p.default.services.auth.accounts.btc.getAddress(),r.myEthAddress=p.default.services.auth.accounts.eth.address,r.stepNumbers={sign:1,"wait-lock-btc":2,"verify-script":3,"sync-balance":4,"lock-eth":5,"wait-withdraw-eth":6,"withdraw-btc":7,finish:8,end:9},!r.ethTokenSwap)throw new Error('ETHTOKEN2BTC: "ethTokenSwap" of type object required');if(!r.btcSwap)throw new Error('ETHTOKEN2BTC: "btcSwap" of type object required');return r.state={step:0,signTransactionHash:null,isSignFetching:!1,isMeSigned:!1,secretHash:null,btcScriptValues:null,btcScriptVerified:!1,isBalanceFetching:!1,isBalanceEnough:!1,balance:null,btcScriptCreatingTransactionHash:null,ethSwapCreationTransactionHash:null,isEthContractFunded:!1,secret:null,isEthWithdrawn:!1,isBtcWithdrawn:!1,refundTransactionHash:null,isFinished:!1},(0,l.default)(n.prototype.__proto__||(0,s.default)(n.prototype),"_persistSteps",r).call(r),r._persistState(),r}return(0,f.default)(n,e),(0,c.default)(n,null,[{key:"getName",value:function(){return t.toUpperCase()+"2"+d.constants.COINS.btc}}]),(0,c.default)(n,[{key:"_persistState",value:function(){(0,l.default)(n.prototype.__proto__||(0,s.default)(n.prototype),"_persistState",this).call(this)}},{key:"_getSteps",value:function(){var t=this,e=this;return console.log("FLOW",e),[function(){},function(){e.swap.room.once("create btc script",function(t){var n=t.scriptValues,r=t.btcScriptCreatingTransactionHash;e.finishStep({secretHash:n.secretHash,btcScriptValues:n,btcScriptCreatingTransactionHash:r},{step:"wait-lock-btc",silentError:!0})}),e.swap.room.sendMessage("request btc script")},function(){},function(){t.syncBalance()},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u,c,f,l,h;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.swap,o=r.participant,s=r.buyAmount,a=r.sellAmount,u=void 0,c=function(){return Math.floor(Date.now()/1e3)},f=function(){return c()+3600},t.next=6,e.btcSwap.checkScript(e.state.btcScriptValues,{value:s,recipientPublicKey:p.default.services.auth.accounts.btc.getPublicKey(),lockTime:f()});case 6:if(!(l=t.sent)){t.next=11;break}return console.error("Btc script check error:",l),e.swap.events.dispatch("btc script check error",l),t.abrupt("return");case 11:return h={participantAddress:o.eth.address,secretHash:e.state.secretHash,amount:a},t.next=14,e.ethTokenSwap.approve({amount:a});case 14:return t.next=16,e.ethTokenSwap.create(h,function(t){u=t,e.setState({ethSwapCreationTransactionHash:t})});case 16:e.swap.room.sendMessage("create eth contract",{ethSwapCreationTransactionHash:u}),e.finishStep({isEthContractFunded:!0});case 18:case"end":return t.stop()}},n,t)})),function(){var n=e.swap.participant,r=void 0;!function s(){r=setTimeout((0,o.default)(i.default.mark(function r(){var o;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=void 0,t.prev=1,t.next=4,e.ethTokenSwap.getSecret({participantAddress:n.eth.address});case 4:o=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:o?e.state.isEthWithdrawn||e.finishStep({isEthWithdrawn:!0,secret:o},{step:"wait-withdraw-eth"}):s();case 10:case"end":return t.stop()}},r,t,[[1,7]])})),2e4)}(),e.swap.room.once("finish eth withdraw",function(){e.state.isEthWithdrawn||(clearTimeout(r),r=null,e.finishStep({isEthWithdrawn:!0},{step:"wait-withdraw-eth"}))})},(0,o.default)(i.default.mark(function n(){var r,o,s;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.swap.participant,o=e.state.secret,s={participantAddress:r.eth.address},o){t.next=15;break}return t.prev=4,t.next=7,e.ethTokenSwap.getSecret(s);case 7:o=t.sent,e.setState({secret:o}),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(4),/known transaction/.test(t.t0.message)||console.error(t.t0),t.abrupt("return");case 15:if(o){t.next=18;break}return console.error("Secret required! Got "+o),t.abrupt("return");case 18:return t.next=20,e.btcSwap.withdraw({scriptValues:e.state.btcScriptValues,secret:o},function(t){e.setState({btcSwapWithdrawTransactionHash:t})});case 20:e.finishStep({isBtcWithdrawn:!0});case 21:case"end":return t.stop()}},n,t,[[4,11]])})),function(){e.swap.room.sendMessage("swap finished"),e.finishStep({isFinished:!0})},function(){}]}},{key:"_checkSwapAlreadyExists",value:function(){var t=this.swap.participant,e={ownerAddress:p.default.services.auth.accounts.eth.address,participantAddress:t.eth.address};return this.ethTokenSwap.checkSwapExists(e)}},{key:"sign",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.swap.participant,!this.state.isMeSigned){t.next=4;break}return t.abrupt("return",this.swap.room.sendMessage("swap sign"));case 4:return t.next=6,this._checkSwapAlreadyExists();case 6:if(!t.sent){t.next=11;break}throw this.swap.room.sendMessage("swap exists"),new Error("Cannot sign: swap with "+e.eth.address+" already exists! Please refund it or drop "+this.swap.id);case 11:return this.setState({isSignFetching:!0}),this.swap.room.once("request sign",function(){n.swap.room.sendMessage("swap sign")}),this.swap.room.sendMessage("swap sign"),this.finishStep({isMeSigned:!0},{step:"sign"}),t.abrupt("return",!0);case 16:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"verifyBtcScript",value:function(){if(this.state.btcScriptVerified)return!0;if(!this.state.btcScriptValues)throw new Error("No script, cannot verify");return this.finishStep({btcScriptVerified:!0},{step:"verify-script"}),!0}},{key:"syncBalance",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.swap.sellAmount,this.setState({isBalanceFetching:!0}),t.next=4,this.ethTokenSwap.fetchBalance(p.default.services.auth.accounts.eth.address);case 4:n=t.sent,e.isLessThanOrEqualTo(n)?this.finishStep({balance:n,isBalanceFetching:!1,isBalanceEnough:!0},{step:"sync-balance"}):this.setState({balance:n,isBalanceFetching:!1,isBalanceEnough:!1});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"tryWithdraw",value:function(){var t=(0,o.default)(i.default.mark(function t(e){var n,o,s,a,u,c,f,l,d,p=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.state,o=n.secret,s=n.secretHash,n.isEthWithdrawn,a=n.isBtcWithdrawn,u=n.btcScriptValues,e){t.next=3;break}throw new Error("Withdrawal is automatic. For manual withdrawal, provide a secret");case 3:if(u){t.next=5;break}throw new Error("Cannot withdraw without script values");case 5:return o&&o!=e&&console.warn("Secret already known and is different. Are you sure?"),a&&console.warn("Looks like money were already withdrawn, are you sure?"),console.log("WITHDRAW using secret = "+e),c=h.default.ripemd160(r.from(e,"hex")).toString("hex"),s!=c&&console.warn("Hash does not match!"),f=this.btcSwap.createScript(u),l=f.scriptAddress,t.next=13,this.btcSwap.getBalance(l);case 13:if(d=t.sent,console.log("address="+l+", balance="+d),0!==d){t.next=18;break}throw flow.finishStep({isBtcWithdrawn:!0},{step:"withdraw-btc"}),new Error("Already withdrawn: address="+l+",balance="+d);case 18:return t.next=20,this.btcSwap.withdraw({scriptValues:u,secret:e},function(t){console.log("TX hash="+t),p.setState({btcSwapWithdrawTransactionHash:t})});case 20:console.log("TX withdraw sent: "+this.state.btcSwapWithdrawTransactionHash),this.finishStep({isBtcWithdrawn:!0},{step:"withdraw-btc"});case 22:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"tryRefund",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n,r,o,s=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.swap.participant,n=this.state,r=n.secret,o=n.btcScriptValues,r="c0809ce9f484fdcdfb2d5aabd609768ce0374ee97a1a5618ce4cd3f16c00a078",t.prev=3,console.log("TRYING REFUND!"),t.prev=5,t.next=8,this.ethTokenSwap.refund({participantAddress:e.eth.address},function(t){s.setState({refundTransactionHash:t})});case 8:return console.log("SUCCESS REFUND!"),t.abrupt("return");case 12:t.prev=12,t.t0=t.catch(5),console.err("REFUND FAILED!",t.t0);case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(3),console.error("Mbe it's still under lockTime?! "+t.t1);case 20:if(o||console.error("You can't do refund w/o btc script values! Try wait until lockTime expires on eth contract!"),r){t.next=32;break}return t.prev=22,t.next=25,this.ethTokenSwap.getSecret(data);case 25:r=t.sent,t.next=32;break;case 28:return t.prev=28,t.t2=t.catch(22),console.error("Can't receive secret from contract"),t.abrupt("return");case 32:return console.log("TRYING WITHDRAW!"),t.prev=33,t.next=36,this.btcSwap.withdraw({scriptValues:this.state.btcScriptValues,secret:r},function(t){s.setState({btcSwapWithdrawTransactionHash:t})});case 36:console.log("SUCCESS WITHDRAW!"),t.next=42;break;case 39:t.prev=39,t.t3=t.catch(33),console.error("WITHDRAW FAILED!",t.t3);case 42:case"end":return t.stop()}},t,this,[[3,17],[5,12],[22,28],[33,39]])}));return function(){return t.apply(this,arguments)}}()}]),n}(v.Flow)},t.exports=e.default}).call(this,n(27).Buffer)},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=w(n(62)),o=w(n(63)),s=w(n(32)),a=w(n(1)),u=w(n(37)),c=w(n(3)),f=w(n(38)),l=w(n(147)),h=w(n(148)),d=n(16),p=w(d),v=n(117);function w(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return function(e){function n(e){(0,a.default)(this,n);var r=(0,u.default)(this,(n.__proto__||(0,s.default)(n)).call(this,e));if(r.getRefundTxHex=function(){r.btcSwap.getRefundHexTransaction({scriptValues:r.state.btcScriptValues,secret:r.state.secret}).then(function(t){r.setState({refundTxHex:t})})},r._flowName=n.getName(),r.ethTokenSwap=p.default.swaps[t.toUpperCase()],r.btcSwap=p.default.swaps[d.constants.COINS.btc],r.myBtcAddress=p.default.services.auth.accounts.btc.getAddress(),r.myEthAddress=p.default.services.auth.accounts.eth.address,r.stepNumbers={sign:1,"submit-secret":2,"sync-balance":3,"lock-btc":4,"wait-lock-eth":5,"withdraw-eth":6,finish:7,end:8},!r.ethTokenSwap)throw new Error('BTC2ETH: "ethTokenSwap" of type object required');if(!r.btcSwap)throw new Error('BTC2ETH: "btcSwap" of type object required');return r.state={step:0,signTransactionHash:null,isSignFetching:!1,isParticipantSigned:!1,btcScriptCreatingTransactionHash:null,ethSwapCreationTransactionHash:null,secretHash:null,btcScriptValues:null,btcScriptVerified:!1,isBalanceFetching:!1,isBalanceEnough:!1,balance:null,isEthContractFunded:!1,ethSwapWithdrawTransactionHash:null,isEthWithdrawn:!1,isBtcWithdrawn:!1,refundTxHex:null,isFinished:!1},(0,l.default)(n.prototype.__proto__||(0,s.default)(n.prototype),"_persistSteps",r).call(r),r._persistState(),r}return(0,f.default)(n,e),(0,c.default)(n,null,[{key:"getName",value:function(){return d.constants.COINS.btc+"2"+t.toUpperCase()}}]),(0,c.default)(n,[{key:"_persistState",value:function(){(0,l.default)(n.prototype.__proto__||(0,s.default)(n.prototype),"_persistState",this).call(this)}},{key:"_getSteps",value:function(){var t=this,e=this;return[function(){e.swap.room.once("swap sign",function(){e.finishStep({isParticipantSigned:!0},{step:"sign",silentError:!0})}),e.swap.room.once("swap exists",function(){console.log("swap already exists")}),e.swap.room.sendMessage("request sign")},function(){},function(){t.syncBalance()},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u,c,f,l;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.swap,o=r.sellAmount,s=r.participant,a=e.state.btcScriptValues,u=void 0,c=function(){return Math.floor(Date.now()/1e3)},f=function(){return c()+10800},l=void 0,a?l=a:(l={secretHash:e.state.secretHash,ownerPublicKey:p.default.services.auth.accounts.btc.getPublicKey(),recipientPublicKey:s.btc.publicKey,lockTime:f()},e.setState({btcScriptValues:l})),console.log("sellAmount",o),t.next=10,e.btcSwap.fundScript({scriptValues:l,amount:o},function(t){u=t,e.setState({btcScriptCreatingTransactionHash:t})});case 10:e.swap.room.on("request btc script",function(){e.swap.room.sendMessage("create btc script",{scriptValues:l,btcScriptCreatingTransactionHash:u})}),e.swap.room.sendMessage("create btc script",{scriptValues:l,btcScriptCreatingTransactionHash:u}),e.finishStep({isBtcScriptFunded:!0,btcScriptValues:l});case 13:case"end":return t.stop()}},n,t)})),function(){var n=e.swap.participant,r=void 0;e.swap.room.once("create eth contract",function(t){var n=t.ethSwapCreationTransactionHash;e.setState({ethSwapCreationTransactionHash:n})});!function s(){r=setTimeout((0,o.default)(i.default.mark(function r(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ethTokenSwap.getBalance({ownerAddress:n.eth.address});case 2:t.sent>0?e.state.isEthContractFunded||e.finishStep({isEthContractFunded:!0},{step:"wait-lock-eth"}):s();case 4:case"end":return t.stop()}},r,t)})),2e4)}(),e.swap.room.once("create eth contract",function(){e.state.isEthContractFunded||(clearTimeout(r),r=null,e.finishStep({isEthContractFunded:!0},{step:"wait-lock-eth"}))})},(0,o.default)(i.default.mark(function n(){var r,o,s,a,u;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.swap,o=r.buyAmount,s=r.participant,a={ownerAddress:s.eth.address,secret:e.state.secret},t.next=4,e.ethTokenSwap.checkBalance({ownerAddress:s.eth.address,expectedValue:o});case 4:if(!(u=t.sent)){t.next=9;break}return console.error("Waiting until deposit: ETH balance check error:",u),e.swap.events.dispatch("eth balance check error",u),t.abrupt("return");case 9:return t.prev=9,t.next=12,e.ethTokenSwap.withdraw(a,function(t){e.setState({ethSwapWithdrawTransactionHash:t})});case 12:t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(9),/known transaction/.test(t.t0.message)||console.error(t.t0),t.abrupt("return");case 18:e.swap.room.sendMessage("finish eth withdraw"),e.finishStep({isEthWithdrawn:!0});case 20:case"end":return t.stop()}},n,t,[[9,14]])})),function(){e.swap.room.once("swap finished",function(){e.finishStep({isFinished:!0})})},function(){}]}},{key:"submitSecret",value:function(t){if(this.state.secretHash)return!0;if(!this.state.isParticipantSigned)throw new Error("Cannot proceed: participant not signed. step="+this.state.step);var e=h.default.ripemd160(r.from(t,"hex")).toString("hex");return this.finishStep({secret:t,secretHash:e},{step:"submit-secret"}),!0}},{key:"syncBalance",value:function(){var t=(0,o.default)(i.default.mark(function t(){var e,n;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.swap.sellAmount,this.setState({isBalanceFetching:!0}),t.next=4,this.btcSwap.fetchBalance(p.default.services.auth.accounts.btc.getAddress());case 4:n=t.sent,e.isLessThanOrEqualTo(n)?this.finishStep({balance:n,isBalanceFetching:!1,isBalanceEnough:!0},{step:"sync-balance"}):this.setState({balance:n,isBalanceFetching:!1,isBalanceEnough:!1});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"tryRefund",value:function(){var t=this;return this.btcSwap.refund({scriptValues:this.state.btcScriptValues,secret:this.state.secret},function(e){t.setState({refundTransactionHash:e})}).then(function(){t.setState({isRefunded:!0})})}}]),n}(v.Flow)},t.exports=e.default}).call(this,n(27).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EthTokenSwap=e.BtcSwap=e.EthSwap=void 0;var r=s(n(229)),i=s(n(230)),o=s(n(231));function s(t){return t&&t.__esModule?t:{default:t}}e.EthSwap=r.default,e.BtcSwap=o.default,e.EthTokenSwap=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(n(62)),i=p(n(63)),o=p(n(111)),s=p(n(32)),a=p(n(1)),u=p(n(3)),c=p(n(37)),f=p(n(38)),l=n(16),h=p(l),d=p(n(109));function p(t){return t&&t.__esModule?t:{default:t}}var v=function(t){function e(t){(0,a.default)(this,e);var n=(0,c.default)(this,(e.__proto__||(0,s.default)(e)).call(this));if(n.addGasPrice=function(t){t=t.toNumber(),n.gasPrice=t},"function"!=typeof t.fetchBalance)throw new Error('EthSwap: "fetchBalance" required');if("string"!=typeof t.address)throw new Error('EthSwap: "address" required');if(!Array.isArray(t.abi))throw new Error('EthSwap: "abi" required');return n.address=t.address,n.abi=t.abi,n._swapName=l.constants.COINS.eth,n.gasLimit=t.gasLimit||3e6,n.gasPrice=t.gasPrice||2e9,n.fetchBalance=t.fetchBalance,n}return(0,f.default)(e,t),(0,u.default)(e,[{key:"_initSwap",value:function(){this.contract=new h.default.env.web3.eth.Contract(this.abi,this.address)}},{key:"create",value:function(t,e){var n=this,s=t.secretHash,a=t.participantAddress,u=t.amount,c=(0,d.default)(10).pow(18),f=new d.default(u.toString()).times(c).integerValue().toNumber();return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var u,c,l,d,p;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c="0x"+s.replace(/^0x/,""),l={from:h.default.services.auth.accounts.eth.address,gas:n.gasLimit,value:f,gasPrice:n.gasPrice},d=[c,a],t.next=5,(u=n.contract.methods).createSwap.apply(u,d).send(l).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 5:p=t.sent,i(p);case 7:case"end":return t.stop()}},t,n)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getBalance",value:function(t){var e=this,n=t.ownerAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0,t.prev=1,t.next=4,e.contract.methods.getBalance(n).call({from:h.default.services.auth.accounts.eth.address});case 4:s=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),o(t.t0);case 10:i(s);case 11:case"end":return t.stop()}},t,e,[[1,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"checkSwapExists",value:function(t){var e=this,n=t.ownerAddress,s=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a,u;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=void 0,t.prev=1,t.next=4,e.contract.methods.swaps(n,s).call();case 4:a=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),o(t.t0);case 10:console.log("swapExists",a),u=parseInt(a.balance),i(u);case 13:case"end":return t.stop()}},t,e,[[1,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"checkBalance",value:function(){var t=(0,i.default)(r.default.mark(function t(e){var n,i,o;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.ownerAddress,i=e.expectedValue,t.next=3,this.getBalance({ownerAddress:n});case 3:if(o=t.sent,!i.isGreaterThan(o)){t.next=6;break}return t.abrupt("return","Expected value: "+i.toNumber()+", got: "+o);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"withdraw",value:function(t,e){var n=this,s=t.ownerAddress,a=t.secret;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var u,c,f;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u="0x"+a.replace(/^0x/,""),c={from:h.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.next=4,n.contract.methods.withdraw(u,s).send(c).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 4:f=t.sent,i(f);case 6:case"end":return t.stop()}},t,n)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"refund",value:function(t,e){var n=this,s=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a,u;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={from:h.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.next=3,n.contract.methods.refund(s).send(a).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 3:u=t.sent,i(u);case 5:case"end":return t.stop()}},t,n)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getSecret",value:function(t){var e=this,n=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var s,a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.contract.methods.getSecret(n).call({from:h.default.services.auth.accounts.eth.address});case 3:s=t.sent,a=s&&!/^0x0+/.test(s)?s:null,i(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),o(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"close",value:function(t,e){var n=this,s=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a,u;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={from:h.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.prev=1,t.next=4,n.contract.methods.close(s).send(a).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 4:u=t.sent,i(u),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),o(t.t0);case 11:case"end":return t.stop()}},t,n,[[1,8]])}));return function(e,n){return t.apply(this,arguments)}}())}}]),e}(l.SwapInterface);e.default=v,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=v(n(62)),i=v(n(63)),o=v(n(111)),s=v(n(46)),a=v(n(32)),u=v(n(1)),c=v(n(3)),f=v(n(37)),l=v(n(38)),h=n(16),d=v(h),p=v(n(109));function v(t){return t&&t.__esModule?t:{default:t}}var w=function(t){function e(t){(0,u.default)(this,e);var n=(0,f.default)(this,(e.__proto__||(0,a.default)(e)).call(this));if(!t.name)throw new Error('EthTokenSwap: "name" required');if(!(0,s.default)(h.constants.COINS).includes(t.name.toUpperCase()))throw new Error('EthTokenSwap: "name" should be correct');if("string"!=typeof t.address)throw new Error('EthTokenSwap: "address" required');if(!Array.isArray(t.abi))throw new Error('EthTokenSwap: "abi" required');if("string"!=typeof t.tokenAddress)throw new Error('EthTokenSwap: "tokenAddress" required');if(!Array.isArray(t.tokenAbi))throw new Error('EthTokenSwap: "tokenAbi" required');return n._swapName=t.name.toUpperCase(),n.address=t.address,n.abi=t.abi,n.decimals=t.decimals,n.tokenAddress=t.tokenAddress,n.tokenAbi=t.tokenAbi,n.gasLimit=t.gasLimit||3e6,n.fetchBalance=t.fetchBalance,n}return(0,l.default)(e,t),(0,c.default)(e,[{key:"_initSwap",value:function(){this.contract=new d.default.env.web3.eth.Contract(this.abi,this.address),this.ERC20=new d.default.env.web3.eth.Contract(this.tokenAbi,this.tokenAddress)}},{key:"approve",value:function(t,e){var n=this,s=t.amount,a=new p.default(String(s)).times(new p.default(10).pow(this.decimals)).decimalPlaces(this.decimals).toNumber();return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.ERC20.methods.approve(n.address,a).send({from:d.default.services.auth.accounts.eth.address,gas:n.gasLimit}).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 3:s=t.sent,i(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o(t.t0);case 10:case"end":return t.stop()}},t,n,[[0,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"checkAllowance",value:function(t){var e=this,n=t.owner,s=t.spender;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.ERC20.methods.allowance(n,s).call({from:d.default.services.auth.accounts.eth.address});case 3:a=t.sent,i(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"create",value:function(t,e){var n=this,s=t.secretHash,a=t.participantAddress,u=t.amount,c=new p.default(String(u)).times(new p.default(10).pow(this.decimals)).decimalPlaces(this.decimals).toNumber();return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var u,f,l,h,p;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u="0x"+s.replace(/^0x/,""),f=[u,a,c,n.tokenAddress],l={from:d.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.prev=3,t.next=6,(h=n.contract.methods).createSwap.apply(h,f).send(l).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 6:p=t.sent,console.log("result",p),i(p),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),o(t.t0);case 14:case"end":return t.stop()}},t,n,[[3,11]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"checkSwapExists",value:function(t){var e=this,n=t.ownerAddress,s=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a,u;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=void 0,t.prev=1,t.next=4,e.contract.methods.swaps(n,s).call();case 4:a=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),o(t.t0);case 10:console.log("swapExists",a),u=parseInt(a.balance),i(u);case 13:case"end":return t.stop()}},t,e,[[1,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getBalance",value:function(t){var e=this,n=t.ownerAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0,t.prev=1,t.next=4,e.contract.methods.getBalance(n).call({from:d.default.services.auth.accounts.eth.address});case 4:s=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),o(t.t0);case 10:console.log("balance",s),i(s);case 12:case"end":return t.stop()}},t,e,[[1,7]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"checkBalance",value:function(){var t=(0,i.default)(r.default.mark(function t(e){var n,i,o;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.ownerAddress,i=e.expectedValue,t.next=3,this.getBalance({ownerAddress:n});case 3:if(o=t.sent,!i.isGreaterThan(o)){t.next=6;break}return t.abrupt("return","Expected value: "+i.toNumber()+", got: "+o);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"withdraw",value:function(t,e){var n=this,s=t.ownerAddress,a=t.secret;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var u,c,f;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u="0x"+a.replace(/^0x/,""),c={from:d.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.prev=2,t.next=5,n.contract.methods.withdraw(u,s).send(c).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 5:f=t.sent,i(f),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),o(t.t0);case 12:case"end":return t.stop()}},t,n,[[2,9]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"refund",value:function(t,e){var n=this,s=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var a,u;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={from:d.default.services.auth.accounts.eth.address,gas:n.gasLimit},t.next=3,n.contract.methods.refund(s).send(a).on("transactionHash",function(t){"function"==typeof e&&e(t)}).on("error",function(t){o(t)});case 3:u=t.sent,i(u);case 5:case"end":return t.stop()}},t,n)}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getSecret",value:function(t){var e=this,n=t.participantAddress;return new o.default(function(){var t=(0,i.default)(r.default.mark(function t(i,o){var s,a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.contract.methods.getSecret(n).call({from:d.default.services.auth.accounts.eth.address});case 3:s=t.sent,a=s&&!/^0x0+/.test(s)?s:null,i(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),o(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}));return function(e,n){return t.apply(this,arguments)}}())}}]),e}(h.SwapInterface);e.default=w,t.exports=e.default},function(t,e,n){"use strict";(function(r){Object.defineProperty(e,"__esModule",{value:!0});var i=v(n(53)),o=v(n(111)),s=v(n(62)),a=v(n(63)),u=v(n(32)),c=v(n(1)),f=v(n(3)),l=v(n(37)),h=v(n(38)),d=n(16),p=v(d);function v(t){return t&&t.__esModule?t:{default:t}}var w=function(t){function e(t){(0,c.default)(this,e);var n=(0,l.default)(this,(e.__proto__||(0,u.default)(e)).call(this));if("function"!=typeof t.fetchBalance)throw new Error('EthSwap: "fetchBalance" required');if("function"!=typeof t.fetchUnspents)throw new Error('EthSwap: "fetchUnspents" required');if("function"!=typeof t.broadcastTx)throw new Error('EthSwap: "broadcastTx" required');return n._swapName=d.constants.COINS.btc,n.fetchBalance=t.fetchBalance,n.fetchUnspents=t.fetchUnspents,n.broadcastTx=t.broadcastTx,n}return(0,h.default)(e,t),(0,f.default)(e,[{key:"_initSwap",value:function(){this.network=p.default.isMainNet()?p.default.env.bitcoin.networks.bitcoin:p.default.env.bitcoin.networks.testnet}},{key:"_signTransaction",value:function(t){var e=t.script,n=t.txRaw,i=t.secret,o=p.default.env.bitcoin.Transaction.SIGHASH_ALL,s=n.hashForSignature(0,e,o),a=p.default.services.auth.accounts.btc.sign(s).toScriptSignature(o),u=p.default.env.bitcoin.script.scriptHash.input.encode([a,p.default.services.auth.accounts.btc.getPublicKeyBuffer(),r.from(i.replace(/^0x/,""),"hex")],e);n.setInputScript(0,u)}},{key:"createScript",value:function(t){var e=t.secretHash,n=t.ownerPublicKey,i=t.recipientPublicKey,o=t.lockTime;console.log("DATA",t);var s=p.default.env.bitcoin.script.compile([p.default.env.bitcoin.opcodes.OP_RIPEMD160,r.from(e,"hex"),p.default.env.bitcoin.opcodes.OP_EQUALVERIFY,r.from(i,"hex"),p.default.env.bitcoin.opcodes.OP_EQUAL,p.default.env.bitcoin.opcodes.OP_IF,r.from(i,"hex"),p.default.env.bitcoin.opcodes.OP_CHECKSIG,p.default.env.bitcoin.opcodes.OP_ELSE,p.default.env.bitcoin.script.number.encode(o),p.default.env.bitcoin.opcodes.OP_CHECKLOCKTIMEVERIFY,p.default.env.bitcoin.opcodes.OP_DROP,r.from(n,"hex"),p.default.env.bitcoin.opcodes.OP_CHECKSIG,p.default.env.bitcoin.opcodes.OP_ENDIF]),a=p.default.env.bitcoin.script.scriptHash.output.encode(p.default.env.bitcoin.crypto.hash160(s));return{scriptAddress:p.default.env.bitcoin.address.fromOutputScript(a,this.network),script:s}}},{key:"checkScript",value:function(){var t=(0,a.default)(s.default.mark(function t(e,n){var r,i,o,a,u,c,f;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.recipientPublicKey,i=e.lockTime,o=this.createScript(e),a=o.scriptAddress,o.script,t.next=4,this.fetchUnspents(a);case 4:if(u=t.sent,c=u.reduce(function(t,e){return t+e.satoshis},0),!(f=n.value.multipliedBy(1e8).integerValue()).isGreaterThan(c)){t.next=9;break}return t.abrupt("return","Expected script value: "+f.toNumber()+", got: "+c);case 9:if(!(n.lockTime>i)){t.next=11;break}return t.abrupt("return","Expected script lockTime: "+n.lockTime+", got: "+i);case 11:if(n.recipientPublicKey===r){t.next=13;break}return t.abrupt("return","Expected script recipient publicKey: "+n.recipientPublicKey+", got: "+r);case 13:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"fundScript",value:function(t,e){var n=this,r=t.scriptValues,i=t.amount;return new o.default(function(){var t=(0,a.default)(s.default.mark(function t(o,a){var u,c,f,l,h,d,v,w,y,g;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,u=n.createScript(r),c=u.scriptAddress,f=new p.default.env.bitcoin.TransactionBuilder(n.network),t.next=5,n.fetchUnspents(p.default.services.auth.accounts.btc.getAddress());case 5:if(l=t.sent,h=i.multipliedBy(1e8).integerValue().toNumber(),d=15e3,v=l.reduce(function(t,e){return t+e.satoshis},0),w=v-h-d,!(v<d+h)){t.next=12;break}throw new Error("Total less than fee: "+v+" < "+d+" + "+h);case 12:return l.forEach(function(t){var e=t.txid,n=t.vout;return f.addInput(e,n)}),f.addOutput(c,h),f.addOutput(p.default.services.auth.accounts.btc.getAddress(),w),f.inputs.forEach(function(t,e){f.sign(e,p.default.services.auth.accounts.btc)}),y=f.buildIncomplete(),"function"==typeof e&&e(y.getId()),t.prev=18,t.next=21,n.broadcastTx(y.toHex());case 21:g=t.sent,o(g),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(18),a(t.t0);case 28:t.next=33;break;case 30:t.prev=30,t.t1=t.catch(0),a(t.t1);case 33:case"end":return t.stop()}},t,n,[[0,30],[18,25]])}));return function(e,n){return t.apply(this,arguments)}}())}},{key:"getBalance",value:function(){var t=(0,a.default)(s.default.mark(function t(e){var n,r,o,a,u;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=void 0,"string"!=typeof e){t.next=5;break}n=e,t.next=11;break;case 5:if("object"!==(void 0===e?"undefined":(0,i.default)(e))){t.next=10;break}r=this.createScript(e),o=r.scriptAddress,n=o,t.next=11;break;case 10:throw new Error("Wrong data type");case 11:return t.next=13,this.fetchUnspents(n);case 13:return a=t.sent,u=a&&a.length&&a.reduce(function(t,e){return t+e.satoshis},0)||0,t.abrupt("return",u);case 16:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getWithdrawRawTransaction",value:function(){var t=(0,a.default)(s.default.mark(function t(e,n){var r,i,o,a,u,c,f,l,h,d;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.scriptValues,i=e.secret,o=this.createScript(r),a=o.script,u=o.scriptAddress,c=new p.default.env.bitcoin.TransactionBuilder(this.network),t.next=5,this.fetchUnspents(u);case 5:if(f=t.sent,l=15e3,!((h=f.reduce(function(t,e){return t+e.satoshis},0))<l)){t.next=10;break}throw new Error("Total less than fee: "+h+" < "+l);case 10:return n&&c.setLockTime(r.lockTime),f.forEach(function(t){var e=t.txid,n=t.vout;return c.addInput(e,n,4294967294)}),c.addOutput(p.default.services.auth.accounts.btc.getAddress(),h-l),d=c.buildIncomplete(),this._signTransaction({script:a,secret:i,txRaw:d}),t.abrupt("return",d);case 16:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getWithdrawHexTransaction",value:function(){var t=(0,a.default)(s.default.mark(function t(e,n){var r;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getWithdrawRawTransaction(e,n);case 2:return r=t.sent,t.abrupt("return",r.toHex());case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getRefundRawTransaction",value:function(t){return this.getWithdrawRawTransaction(t,!0)}},{key:"getRefundHexTransaction",value:function(){var t=(0,a.default)(s.default.mark(function t(e){var n;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getRefundRawTransaction(e);case 2:return n=t.sent,t.abrupt("return",n.toHex());case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"withdraw",value:function(t,e,n){var r=this;return new o.default(function(){var i=(0,a.default)(s.default.mark(function i(o,a){var u,c;return s.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r.getWithdrawRawTransaction(t,n);case 3:return u=i.sent,"function"==typeof e&&e(u.getId()),i.next=7,r.broadcastTx(u.toHex());case 7:c=i.sent,o(c),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(0),a(i.t0);case 14:case"end":return i.stop()}},i,r,[[0,11]])}));return function(t,e){return i.apply(this,arguments)}}())}},{key:"refund",value:function(t,e){return this.withdraw(t,e,!0)}}]),e}(d.SwapInterface);e.default=w,t.exports=e.default}).call(this,n(27).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(117)),i=h(n(142)),o=h(n(175)),s=h(n(194)),a=l(n(228)),u=l(n(203)),c=n(16),f=h(c);function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function h(t){return t&&t.__esModule?t:{default:t}}e.default={app:f.default,constants:c.constants,util:c.util,swaps:a,flows:u,auth:i.default,room:o.default,orders:s.default,Swap:r.default},t.exports=e.default}])});